import{aA as yr,aK as Sl,aC as Le,az as lr,aO as si,aD as xt,aL as Kt,aJ as El,dV as Nt}from"./index-BGLdF6jF.js";import"./index-CuHybtft-BXlf5Z1L.js";var it={},ht={},Es=hr;hr.default=hr;hr.stable=Is;hr.stableStringify=Is;var Kr="[...]",As="[Circular]",Tt=[],Et=[];function Rs(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function hr(e,t,r,n){typeof n>"u"&&(n=Rs()),io(e,"",0,[],void 0,0,n);var o;try{Et.length===0?o=JSON.stringify(e,t,r):o=JSON.stringify(e,Ts(t),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Tt.length!==0;){var i=Tt.pop();i.length===4?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function Wt(e,t,r,n){var o=Object.getOwnPropertyDescriptor(n,r);o.get!==void 0?o.configurable?(Object.defineProperty(n,r,{value:e}),Tt.push([n,r,t,o])):Et.push([t,r,e]):(n[r]=e,Tt.push([n,r,t]))}function io(e,t,r,n,o,i,s){i+=1;var u;if(typeof e=="object"&&e!==null){for(u=0;u<n.length;u++)if(n[u]===e){Wt(As,e,t,o);return}if(typeof s.depthLimit<"u"&&i>s.depthLimit){Wt(Kr,e,t,o);return}if(typeof s.edgesLimit<"u"&&r+1>s.edgesLimit){Wt(Kr,e,t,o);return}if(n.push(e),Array.isArray(e))for(u=0;u<e.length;u++)io(e[u],u,u,n,e,i,s);else{var l=Object.keys(e);for(u=0;u<l.length;u++){var c=l[u];io(e[c],c,u,n,e,i,s)}}n.pop()}}function Al(e,t){return e<t?-1:e>t?1:0}function Is(e,t,r,n){typeof n>"u"&&(n=Rs());var o=so(e,"",0,[],void 0,0,n)||e,i;try{Et.length===0?i=JSON.stringify(o,t,r):i=JSON.stringify(o,Ts(t),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Tt.length!==0;){var s=Tt.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return i}function so(e,t,r,n,o,i,s){i+=1;var u;if(typeof e=="object"&&e!==null){for(u=0;u<n.length;u++)if(n[u]===e){Wt(As,e,t,o);return}try{if(typeof e.toJSON=="function")return}catch{return}if(typeof s.depthLimit<"u"&&i>s.depthLimit){Wt(Kr,e,t,o);return}if(typeof s.edgesLimit<"u"&&r+1>s.edgesLimit){Wt(Kr,e,t,o);return}if(n.push(e),Array.isArray(e))for(u=0;u<e.length;u++)so(e[u],u,u,n,e,i,s);else{var l={},c=Object.keys(e).sort(Al);for(u=0;u<c.length;u++){var p=c[u];so(e[p],p,u,n,e,i,s),l[p]=e[p]}if(typeof o<"u")Tt.push([o,t,e]),o[t]=l;else return l}n.pop()}}function Ts(e){return e=typeof e<"u"?e:function(t,r){return r},function(t,r){if(Et.length>0)for(var n=0;n<Et.length;n++){var o=Et[n];if(o[1]===t&&o[0]===r){r=o[2],Et.splice(n,1);break}}return e.call(this,t,r)}}const Rl=Kt(Es);Object.defineProperty(ht,"__esModule",{value:!0});ht.EthereumProviderError=ht.EthereumRpcError=void 0;const Il=Es;class Os extends Error{constructor(t,r,n){if(!Number.isInteger(t))throw new Error('"code" must be an integer.');if(!r||typeof r!="string")throw new Error('"message" must be a nonempty string.');super(r),this.code=t,n!==void 0&&(this.data=n)}serialize(){const t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data),this.stack&&(t.stack=this.stack),t}toString(){return Il.default(this.serialize(),Pl,2)}}ht.EthereumRpcError=Os;class Tl extends Os{constructor(t,r,n){if(!Ol(t))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(t,r,n)}}ht.EthereumProviderError=Tl;function Ol(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}function Pl(e,t){if(t!=="[Circular]")return t}var Io={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});pt.errorValues=pt.errorCodes=void 0;pt.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}};pt.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.serializeError=e.isValidCode=e.getMessageFromCode=e.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const t=pt,r=ht,n=t.errorCodes.rpc.internal,o="Unspecified error message. This is a bug, please report it.",i={code:n,message:s(n)};e.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.";function s(g,A=o){if(Number.isInteger(g)){const R=g.toString();if(y(t.errorValues,R))return t.errorValues[R].message;if(c(g))return e.JSON_RPC_SERVER_ERROR_MESSAGE}return A}e.getMessageFromCode=s;function u(g){if(!Number.isInteger(g))return!1;const A=g.toString();return!!(t.errorValues[A]||c(g))}e.isValidCode=u;function l(g,{fallbackError:A=i,shouldIncludeStack:R=!1}={}){var h,b;if(!A||!Number.isInteger(A.code)||typeof A.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(g instanceof r.EthereumRpcError)return g.serialize();const _={};if(g&&typeof g=="object"&&!Array.isArray(g)&&y(g,"code")&&u(g.code)){const S=g;_.code=S.code,S.message&&typeof S.message=="string"?(_.message=S.message,y(S,"data")&&(_.data=S.data)):(_.message=s(_.code),_.data={originalError:p(g)})}else{_.code=A.code;const S=(h=g)===null||h===void 0?void 0:h.message;_.message=S&&typeof S=="string"?S:A.message,_.data={originalError:p(g)}}const T=(b=g)===null||b===void 0?void 0:b.stack;return R&&g&&T&&typeof T=="string"&&(_.stack=T),_}e.serializeError=l;function c(g){return g>=-32099&&g<=-32e3}function p(g){return g&&typeof g=="object"&&!Array.isArray(g)?Object.assign({},g):g}function y(g,A){return Object.prototype.hasOwnProperty.call(g,A)}})(Io);var tn={};Object.defineProperty(tn,"__esModule",{value:!0});tn.ethErrors=void 0;const To=ht,Ps=Io,Re=pt;tn.ethErrors={rpc:{parse:e=>Ce(Re.errorCodes.rpc.parse,e),invalidRequest:e=>Ce(Re.errorCodes.rpc.invalidRequest,e),invalidParams:e=>Ce(Re.errorCodes.rpc.invalidParams,e),methodNotFound:e=>Ce(Re.errorCodes.rpc.methodNotFound,e),internal:e=>Ce(Re.errorCodes.rpc.internal,e),server:e=>{if(!e||typeof e!="object"||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return Ce(t,e)},invalidInput:e=>Ce(Re.errorCodes.rpc.invalidInput,e),resourceNotFound:e=>Ce(Re.errorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>Ce(Re.errorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>Ce(Re.errorCodes.rpc.transactionRejected,e),methodNotSupported:e=>Ce(Re.errorCodes.rpc.methodNotSupported,e),limitExceeded:e=>Ce(Re.errorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>ir(Re.errorCodes.provider.userRejectedRequest,e),unauthorized:e=>ir(Re.errorCodes.provider.unauthorized,e),unsupportedMethod:e=>ir(Re.errorCodes.provider.unsupportedMethod,e),disconnected:e=>ir(Re.errorCodes.provider.disconnected,e),chainDisconnected:e=>ir(Re.errorCodes.provider.chainDisconnected,e),custom:e=>{if(!e||typeof e!="object"||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:t,message:r,data:n}=e;if(!r||typeof r!="string")throw new Error('"message" must be a nonempty string');return new To.EthereumProviderError(t,r,n)}}};function Ce(e,t){const[r,n]=xs(t);return new To.EthereumRpcError(e,r||Ps.getMessageFromCode(e),n)}function ir(e,t){const[r,n]=xs(t);return new To.EthereumProviderError(e,r||Ps.getMessageFromCode(e),n)}function xs(e){if(e){if(typeof e=="string")return[e];if(typeof e=="object"&&!Array.isArray(e)){const{message:t,data:r}=e;if(t&&typeof t!="string")throw new Error("Must specify string message.");return[t||void 0,r]}}return[]}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getMessageFromCode=e.serializeError=e.EthereumProviderError=e.EthereumRpcError=e.ethErrors=e.errorCodes=void 0;const t=ht;Object.defineProperty(e,"EthereumRpcError",{enumerable:!0,get:function(){return t.EthereumRpcError}}),Object.defineProperty(e,"EthereumProviderError",{enumerable:!0,get:function(){return t.EthereumProviderError}});const r=Io;Object.defineProperty(e,"serializeError",{enumerable:!0,get:function(){return r.serializeError}}),Object.defineProperty(e,"getMessageFromCode",{enumerable:!0,get:function(){return r.getMessageFromCode}});const n=tn;Object.defineProperty(e,"ethErrors",{enumerable:!0,get:function(){return n.ethErrors}});const o=pt;Object.defineProperty(e,"errorCodes",{enumerable:!0,get:function(){return o.errorCodes}})})(it);function pr(e){"@babel/helpers - typeof";return pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pr(e)}function xl(e,t){if(pr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pr(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nl(e){var t=xl(e,"string");return pr(t)=="symbol"?t:t+""}function z(e,t,r){return(t=Nl(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ai(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function De(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ai(Object(r),!0).forEach(function(n){z(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ai(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Ns={exports:{}},Cn={exports:{}};let kl=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);let t="";for(let r=0;r<e.length;r++)t+=`    ${e[r].stack}
`;super(t),this.name="AggregateError",this.errors=e}};var fe={AggregateError:kl,ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,r){return e.slice(t,r)},Error,FunctionPrototypeCall(e,t,...r){return e.call(t,...r)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,r){return Object.defineProperty(e,t,r)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,r){return e.then(t,r)},PromiseReject(e){return Promise.reject(e)},PromiseResolve(e){return Promise.resolve(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,r){return e.slice(t,r)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(e,t,r){return e.set(t,r)},Boolean,Uint8Array},ks={exports:{}},Ls={format(e,...t){return e.replace(/%([sdifj])/g,function(...[r,n]){const o=t.shift();return n==="f"?o.toFixed(6):n==="j"?JSON.stringify(o):n==="s"&&typeof o=="object"?`${o.constructor!==Object?o.constructor.name:""} {}`.trim():o.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}};const{format:Ll,inspect:Jr}=Ls,{AggregateError:jl}=fe,Cl=globalThis.AggregateError||jl,Bl=Symbol("kIsNodeError"),Ml=["string","function","number","object","Function","Object","boolean","bigint","symbol"],Dl=/^([A-Z][a-z0-9]*)+$/,Ul="__node_internal_",rn={};function Rt(e,t){if(!e)throw new rn.ERR_INTERNAL_ASSERTION(t)}function li(e){let t="",r=e.length;const n=e[0]==="-"?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function Wl(e,t,r){if(typeof t=="function")return Rt(t.length<=r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${t.length}).`),t(...r);const n=(t.match(/%[dfijoOs]/g)||[]).length;return Rt(n===r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${n}).`),r.length===0?t:Ll(t,...r)}function Se(e,t,r){r||(r=Error);class n extends r{constructor(...i){super(Wl(e,t,i))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=e,n.prototype[Bl]=!0,rn[e]=n}function ui(e){const t=Ul+e.name;return Object.defineProperty(e,"name",{value:t}),e}function Fl(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const r=new Cl([t,e],t.message);return r.code=t.code,r}return e||t}let $l=class extends Error{constructor(e="The operation was aborted",t=void 0){if(t!==void 0&&typeof t!="object")throw new rn.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}};Se("ERR_ASSERTION","%s",Error);Se("ERR_INVALID_ARG_TYPE",(e,t,r)=>{Rt(typeof e=="string","'name' must be a string"),Array.isArray(t)||(t=[t]);let n="The ";e.endsWith(" argument")?n+=`${e} `:n+=`"${e}" ${e.includes(".")?"property":"argument"} `,n+="must be ";const o=[],i=[],s=[];for(const l of t)Rt(typeof l=="string","All expected entries have to be of type string"),Ml.includes(l)?o.push(l.toLowerCase()):Dl.test(l)?i.push(l):(Rt(l!=="object",'The value "object" should be written as "Object"'),s.push(l));if(i.length>0){const l=o.indexOf("object");l!==-1&&(o.splice(o,l,1),i.push("Object"))}if(o.length>0){switch(o.length){case 1:n+=`of type ${o[0]}`;break;case 2:n+=`one of type ${o[0]} or ${o[1]}`;break;default:{const l=o.pop();n+=`one of type ${o.join(", ")}, or ${l}`}}(i.length>0||s.length>0)&&(n+=" or ")}if(i.length>0){switch(i.length){case 1:n+=`an instance of ${i[0]}`;break;case 2:n+=`an instance of ${i[0]} or ${i[1]}`;break;default:{const l=i.pop();n+=`an instance of ${i.join(", ")}, or ${l}`}}s.length>0&&(n+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(n+="an "),n+=`${s[0]}`;break;case 2:n+=`one of ${s[0]} or ${s[1]}`;break;default:{const l=s.pop();n+=`one of ${s.join(", ")}, or ${l}`}}if(r==null)n+=`. Received ${r}`;else if(typeof r=="function"&&r.name)n+=`. Received function ${r.name}`;else if(typeof r=="object"){var u;if((u=r.constructor)!==null&&u!==void 0&&u.name)n+=`. Received an instance of ${r.constructor.name}`;else{const l=Jr(r,{depth:-1});n+=`. Received ${l}`}}else{let l=Jr(r,{colors:!1});l.length>25&&(l=`${l.slice(0,25)}...`),n+=`. Received type ${typeof r} (${l})`}return n},TypeError);Se("ERR_INVALID_ARG_VALUE",(e,t,r="is invalid")=>{let n=Jr(t);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${r}. Received ${n}`},TypeError);Se("ERR_INVALID_RETURN_VALUE",(e,t,r)=>{var n;const o=r!=null&&(n=r.constructor)!==null&&n!==void 0&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${e} to be returned from the "${t}" function but got ${o}.`},TypeError);Se("ERR_MISSING_ARGS",(...e)=>{Rt(e.length>0,"At least one arg needs to be specified");let t;const r=e.length;switch(e=(Array.isArray(e)?e:[e]).map(n=>`"${n}"`).join(" or "),r){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const n=e.pop();t+=`The ${e.join(", ")}, and ${n} arguments`}break}return`${t} must be specified`},TypeError);Se("ERR_OUT_OF_RANGE",(e,t,r)=>{Rt(t,'Missing "range" argument');let n;if(Number.isInteger(r)&&Math.abs(r)>2**32)n=li(String(r));else if(typeof r=="bigint"){n=String(r);const o=BigInt(2)**BigInt(32);(r>o||r<-o)&&(n=li(n)),n+="n"}else n=Jr(r);return`The value of "${e}" is out of range. It must be ${t}. Received ${n}`},RangeError);Se("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);Se("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);Se("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);Se("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);Se("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);Se("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Se("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);Se("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);Se("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);Se("ERR_STREAM_WRITE_AFTER_END","write after end",Error);Se("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var Ie={AbortError:$l,aggregateTwoErrors:ui(Fl),hideStackFrames:ui,codes:rn},sr={exports:{}},ci;function gr(){if(ci)return sr.exports;ci=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return sr.exports=e,sr.exports.AbortSignal=t,sr.exports.default=e,sr.exports}(function(e){const t=xt,{format:r,inspect:n}=Ls,{codes:{ERR_INVALID_ARG_TYPE:o}}=Ie,{kResistStopPropagation:i,AggregateError:s,SymbolDispose:u}=fe,l=globalThis.AbortSignal||gr().AbortSignal,c=globalThis.AbortController||gr().AbortController,p=Object.getPrototypeOf(async function(){}).constructor,y=globalThis.Blob||t.Blob,g=typeof y<"u"?function(h){return h instanceof y}:function(h){return!1},A=(h,b)=>{if(h!==void 0&&(h===null||typeof h!="object"||!("aborted"in h)))throw new o(b,"AbortSignal",h)},R=(h,b)=>{if(typeof h!="function")throw new o(b,"Function",h)};e.exports={AggregateError:s,kEmptyObject:Object.freeze({}),once(h){let b=!1;return function(..._){b||(b=!0,h.apply(this,_))}},createDeferredPromise:function(){let h,b;return{promise:new Promise((_,T)=>{h=_,b=T}),resolve:h,reject:b}},promisify(h){return new Promise((b,_)=>{h((T,...S)=>T?_(T):b(...S))})},debuglog(){return function(){}},format:r,inspect:n,types:{isAsyncFunction(h){return h instanceof p},isArrayBufferView(h){return ArrayBuffer.isView(h)}},isBlob:g,deprecate(h,b){return h},addAbortListener:yr.addAbortListener||function(h,b){if(h===void 0)throw new o("signal","AbortSignal",h);A(h,"signal"),R(b,"listener");let _;return h.aborted?queueMicrotask(()=>b()):(h.addEventListener("abort",b,{__proto__:null,once:!0,[i]:!0}),_=()=>{h.removeEventListener("abort",b)}),{__proto__:null,[u](){var T;(T=_)===null||T===void 0||T()}}},AbortSignalAny:l.any||function(h){if(h.length===1)return h[0];const b=new c,_=()=>b.abort();return h.forEach(T=>{A(T,"signals"),T.addEventListener("abort",_,{once:!0})}),b.signal.addEventListener("abort",()=>{h.forEach(T=>T.removeEventListener("abort",_))},{once:!0}),b.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(ks);var je=ks.exports,Oo={};const{ArrayIsArray:js,ArrayPrototypeIncludes:ql,ArrayPrototypeJoin:Hl,ArrayPrototypeMap:zl,NumberIsInteger:Po,NumberIsNaN:Rh,NumberMAX_SAFE_INTEGER:Vl,NumberMIN_SAFE_INTEGER:Gl,NumberParseInt:Ih,ObjectPrototypeHasOwnProperty:Kl,RegExpPrototypeExec:Th,String:Jl,StringPrototypeToUpperCase:Oh,StringPrototypeTrim:Ph}=fe,{hideStackFrames:Ue,codes:{ERR_SOCKET_BAD_PORT:xh,ERR_INVALID_ARG_TYPE:We,ERR_INVALID_ARG_VALUE:Cs,ERR_OUT_OF_RANGE:qt,ERR_UNKNOWN_SIGNAL:Nh}}=Ie,{isAsyncFunction:Zl,isArrayBufferView:Yl}=je.types,Ql=Ue((e,t,r=Gl,n=Vl)=>{if(typeof e!="number")throw new We(t,"number",e);if(!Po(e))throw new qt(t,"an integer",e);if(e<r||e>n)throw new qt(t,`>= ${r} && <= ${n}`,e)});Ue((e,t,r=-2147483648,n=2147483647)=>{if(typeof e!="number")throw new We(t,"number",e);if(!Po(e))throw new qt(t,"an integer",e);if(e<r||e>n)throw new qt(t,`>= ${r} && <= ${n}`,e)});Ue((e,t,r=!1)=>{if(typeof e!="number")throw new We(t,"number",e);if(!Po(e))throw new qt(t,"an integer",e);const n=r?1:0,o=4294967295;if(e<n||e>o)throw new qt(t,`>= ${n} && <= ${o}`,e)});Ue((e,t,r)=>{if(!ql(r,e)){const n="must be one of: "+Hl(zl(r,o=>typeof o=="string"?`'${o}'`:Jl(o)),", ");throw new Cs(t,e,n)}});function Xl(e,t){if(typeof e!="boolean")throw new We(t,"boolean",e)}function Bn(e,t,r){return e==null||!Kl(e,t)?r:e[t]}const eu=Ue((e,t,r=null)=>{const n=Bn(r,"allowArray",!1),o=Bn(r,"allowFunction",!1);if(!Bn(r,"nullable",!1)&&e===null||!n&&js(e)||typeof e!="object"&&(!o||typeof e!="function"))throw new We(t,"Object",e)});Ue((e,t)=>{if(e!=null&&typeof e!="object"&&typeof e!="function")throw new We(t,"a dictionary",e)});Ue((e,t,r=0)=>{if(!js(e))throw new We(t,"Array",e);if(e.length<r){const n=`must be longer than ${r}`;throw new Cs(t,e,n)}});Ue((e,t="buffer")=>{if(!Yl(e))throw new We(t,["Buffer","TypedArray","DataView"],e)});const tu=Ue((e,t)=>{if(e!==void 0&&(e===null||typeof e!="object"||!("aborted"in e)))throw new We(t,"AbortSignal",e)}),ru=Ue((e,t)=>{if(typeof e!="function")throw new We(t,"Function",e)});Ue((e,t)=>{if(typeof e!="function"||Zl(e))throw new We(t,"Function",e)});Ue((e,t)=>{if(e!==void 0)throw new We(t,"undefined",e)});var wr={validateBoolean:Xl,validateFunction:ru,validateInteger:Ql,validateObject:eu,validateAbortSignal:tu},xo={exports:{}};const{SymbolAsyncIterator:di,SymbolIterator:fi,SymbolFor:kt}=fe,Bs=kt("nodejs.stream.destroyed"),nu=kt("nodejs.stream.errored"),hi=kt("nodejs.stream.readable"),pi=kt("nodejs.stream.writable"),ou=kt("nodejs.stream.disturbed"),iu=kt("nodejs.webstream.isClosedPromise"),su=kt("nodejs.webstream.controllerErrorFunction");function No(e,t=!1){var r;return!!(e&&typeof e.pipe=="function"&&typeof e.on=="function"&&(!t||typeof e.pause=="function"&&typeof e.resume=="function")&&(!e._writableState||((r=e._readableState)===null||r===void 0?void 0:r.readable)!==!1)&&(!e._writableState||e._readableState))}function nn(e){var t;return!!(e&&typeof e.write=="function"&&typeof e.on=="function"&&(!e._readableState||((t=e._writableState)===null||t===void 0?void 0:t.writable)!==!1))}function au(e){return!!(e&&typeof e.pipe=="function"&&e._readableState&&typeof e.on=="function"&&typeof e.write=="function")}function Je(e){return e&&(e._readableState||e._writableState||typeof e.write=="function"&&typeof e.on=="function"||typeof e.pipe=="function"&&typeof e.on=="function")}function Ms(e){return!!(e&&!Je(e)&&typeof e.pipeThrough=="function"&&typeof e.getReader=="function"&&typeof e.cancel=="function")}function Ds(e){return!!(e&&!Je(e)&&typeof e.getWriter=="function"&&typeof e.abort=="function")}function Us(e){return!!(e&&!Je(e)&&typeof e.readable=="object"&&typeof e.writable=="object")}function lu(e){return Ms(e)||Ds(e)||Us(e)}function uu(e,t){return e==null?!1:t===!0?typeof e[di]=="function":t===!1?typeof e[fi]=="function":typeof e[di]=="function"||typeof e[fi]=="function"}function on(e){if(!Je(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!!(e.destroyed||e[Bs]||n!=null&&n.destroyed)}function cu(e){if(!nn(e))return null;if(e.writableEnded===!0)return!0;const t=e._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function du(e,t){if(!nn(e))return null;if(e.writableFinished===!0)return!0;const r=e._writableState;return r!=null&&r.errored?!1:typeof(r==null?void 0:r.finished)!="boolean"?null:!!(r.finished||t===!1&&r.ended===!0&&r.length===0)}function Ws(e,t){if(!No(e))return null;const r=e._readableState;return r!=null&&r.errored?!1:typeof(r==null?void 0:r.endEmitted)!="boolean"?null:!!(r.endEmitted||t===!1&&r.ended===!0&&r.length===0)}function Fs(e){return e&&e[hi]!=null?e[hi]:typeof(e==null?void 0:e.readable)!="boolean"?null:on(e)?!1:No(e)&&e.readable&&!Ws(e)}function $s(e){return e&&e[pi]!=null?e[pi]:typeof(e==null?void 0:e.writable)!="boolean"?null:on(e)?!1:nn(e)&&e.writable&&!cu(e)}function fu(e,t){return Je(e)?on(e)?!0:!((t==null?void 0:t.readable)!==!1&&Fs(e)||(t==null?void 0:t.writable)!==!1&&$s(e)):null}function hu(e){var t,r;return Je(e)?e.writableErrored?e.writableErrored:(t=(r=e._writableState)===null||r===void 0?void 0:r.errored)!==null&&t!==void 0?t:null:null}function pu(e){var t,r;return Je(e)?e.readableErrored?e.readableErrored:(t=(r=e._readableState)===null||r===void 0?void 0:r.errored)!==null&&t!==void 0?t:null:null}function gu(e){if(!Je(e))return null;if(typeof e.closed=="boolean")return e.closed;const t=e._writableState,r=e._readableState;return typeof(t==null?void 0:t.closed)=="boolean"||typeof(r==null?void 0:r.closed)=="boolean"?(t==null?void 0:t.closed)||(r==null?void 0:r.closed):typeof e._closed=="boolean"&&qs(e)?e._closed:null}function qs(e){return typeof e._closed=="boolean"&&typeof e._defaultKeepAlive=="boolean"&&typeof e._removedConnection=="boolean"&&typeof e._removedContLen=="boolean"}function bu(e){return typeof e._sent100=="boolean"&&qs(e)}function mu(e){var t;return typeof e._consuming=="boolean"&&typeof e._dumped=="boolean"&&((t=e.req)===null||t===void 0?void 0:t.upgradeOrConnect)===void 0}function yu(e){if(!Je(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!n&&bu(e)||!!(n&&n.autoDestroy&&n.emitClose&&n.closed===!1)}function wu(e){var t;return!!(e&&((t=e[ou])!==null&&t!==void 0?t:e.readableDidRead||e.readableAborted))}function _u(e){var t,r,n,o,i,s,u,l,c,p;return!!(e&&((t=(r=(n=(o=(i=(s=e[nu])!==null&&s!==void 0?s:e.readableErrored)!==null&&i!==void 0?i:e.writableErrored)!==null&&o!==void 0?o:(u=e._readableState)===null||u===void 0?void 0:u.errorEmitted)!==null&&n!==void 0?n:(l=e._writableState)===null||l===void 0?void 0:l.errorEmitted)!==null&&r!==void 0?r:(c=e._readableState)===null||c===void 0?void 0:c.errored)!==null&&t!==void 0?t:!((p=e._writableState)===null||p===void 0)&&p.errored))}var lt={isDestroyed:on,kIsDestroyed:Bs,isDisturbed:wu,isErrored:_u,isReadable:Fs,kIsClosedPromise:iu,kControllerErrorFunction:su,isClosed:gu,isDuplexNodeStream:au,isFinished:fu,isIterable:uu,isReadableNodeStream:No,isReadableStream:Ms,isReadableFinished:Ws,isReadableErrored:pu,isNodeStream:Je,isWebStream:lu,isWritable:$s,isWritableNodeStream:nn,isWritableStream:Ds,isWritableFinished:du,isWritableErrored:hu,isServerRequest:mu,willEmitClose:yu,isTransformStream:Us};const Ut=Nt,{AbortError:Hs,codes:vu}=Ie,{ERR_INVALID_ARG_TYPE:Su,ERR_STREAM_PREMATURE_CLOSE:gi}=vu,{kEmptyObject:ao,once:lo}=je,{validateAbortSignal:Eu,validateFunction:Au,validateObject:Ru,validateBoolean:Iu}=wr,{Promise:Tu,PromisePrototypeThen:Ou,SymbolDispose:zs}=fe,{isClosed:Pu,isReadable:bi,isReadableNodeStream:Mn,isReadableStream:xu,isReadableFinished:mi,isReadableErrored:yi,isWritable:wi,isWritableNodeStream:_i,isWritableStream:Nu,isWritableFinished:vi,isWritableErrored:Si,isNodeStream:ku,willEmitClose:Lu,kIsClosedPromise:ju}=lt;let Ft;function Cu(e){return e.setHeader&&typeof e.abort=="function"}const uo=()=>{};function Vs(e,t,r){var n,o;if(arguments.length===2?(r=t,t=ao):t==null?t=ao:Ru(t,"options"),Au(r,"callback"),Eu(t.signal,"options.signal"),r=lo(r),xu(e)||Nu(e))return Bu(e,t,r);if(!ku(e))throw new Su("stream",["ReadableStream","WritableStream","Stream"],e);const i=(n=t.readable)!==null&&n!==void 0?n:Mn(e),s=(o=t.writable)!==null&&o!==void 0?o:_i(e),u=e._writableState,l=e._readableState,c=()=>{e.writable||g()};let p=Lu(e)&&Mn(e)===i&&_i(e)===s,y=vi(e,!1);const g=()=>{y=!0,e.destroyed&&(p=!1),!(p&&(!e.readable||i))&&(!i||A)&&r.call(e)};let A=mi(e,!1);const R=()=>{A=!0,e.destroyed&&(p=!1),!(p&&(!e.writable||s))&&(!s||y)&&r.call(e)},h=k=>{r.call(e,k)};let b=Pu(e);const _=()=>{b=!0;const k=Si(e)||yi(e);if(k&&typeof k!="boolean")return r.call(e,k);if(i&&!A&&Mn(e,!0)&&!mi(e,!1))return r.call(e,new gi);if(s&&!y&&!vi(e,!1))return r.call(e,new gi);r.call(e)},T=()=>{b=!0;const k=Si(e)||yi(e);if(k&&typeof k!="boolean")return r.call(e,k);r.call(e)},S=()=>{e.req.on("finish",g)};Cu(e)?(e.on("complete",g),p||e.on("abort",_),e.req?S():e.on("request",S)):s&&!u&&(e.on("end",c),e.on("close",c)),!p&&typeof e.aborted=="boolean"&&e.on("aborted",_),e.on("end",R),e.on("finish",g),t.error!==!1&&e.on("error",h),e.on("close",_),b?Ut.nextTick(_):u!=null&&u.errorEmitted||l!=null&&l.errorEmitted?p||Ut.nextTick(T):(!i&&(!p||bi(e))&&(y||wi(e)===!1)||!s&&(!p||wi(e))&&(A||bi(e)===!1)||l&&e.req&&e.aborted)&&Ut.nextTick(T);const F=()=>{r=uo,e.removeListener("aborted",_),e.removeListener("complete",g),e.removeListener("abort",_),e.removeListener("request",S),e.req&&e.req.removeListener("finish",g),e.removeListener("end",c),e.removeListener("close",c),e.removeListener("finish",g),e.removeListener("end",R),e.removeListener("error",h),e.removeListener("close",_)};if(t.signal&&!b){const k=()=>{const C=r;F(),C.call(e,new Hs(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)Ut.nextTick(k);else{Ft=Ft||je.addAbortListener;const C=Ft(t.signal,k),H=r;r=lo((...U)=>{C[zs](),H.apply(e,U)})}}return F}function Bu(e,t,r){let n=!1,o=uo;if(t.signal)if(o=()=>{n=!0,r.call(e,new Hs(void 0,{cause:t.signal.reason}))},t.signal.aborted)Ut.nextTick(o);else{Ft=Ft||je.addAbortListener;const s=Ft(t.signal,o),u=r;r=lo((...l)=>{s[zs](),u.apply(e,l)})}const i=(...s)=>{n||Ut.nextTick(()=>r.apply(e,s))};return Ou(e[ju].promise,i,i),uo}function Mu(e,t){var r;let n=!1;return t===null&&(t=ao),(r=t)!==null&&r!==void 0&&r.cleanup&&(Iu(t.cleanup,"cleanup"),n=t.cleanup),new Tu((o,i)=>{const s=Vs(e,t,u=>{n&&s(),u?i(u):o()})})}xo.exports=Vs;xo.exports.finished=Mu;var gt=xo.exports;const Ge=Nt,{aggregateTwoErrors:Du,codes:{ERR_MULTIPLE_CALLBACK:Uu},AbortError:Wu}=Ie,{Symbol:Gs}=fe,{kIsDestroyed:Fu,isDestroyed:$u,isFinished:qu,isServerRequest:Hu}=lt,Ks=Gs("kDestroy"),co=Gs("kConstruct");function Js(e,t,r){e&&(e.stack,t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function zu(e,t){const r=this._readableState,n=this._writableState,o=n||r;return n!=null&&n.destroyed||r!=null&&r.destroyed?(typeof t=="function"&&t(),this):(Js(e,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),o.constructed?Ei(this,e,t):this.once(Ks,function(i){Ei(this,Du(i,e),t)}),this)}function Ei(e,t,r){let n=!1;function o(i){if(n)return;n=!0;const s=e._readableState,u=e._writableState;Js(i,u,s),u&&(u.closed=!0),s&&(s.closed=!0),typeof r=="function"&&r(i),i?Ge.nextTick(Vu,e,i):Ge.nextTick(Zs,e)}try{e._destroy(t||null,o)}catch(i){o(i)}}function Vu(e,t){fo(e,t),Zs(e)}function Zs(e){const t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(r!=null&&r.emitClose||t!=null&&t.emitClose)&&e.emit("close")}function fo(e,t){const r=e._readableState,n=e._writableState;n!=null&&n.errorEmitted||r!=null&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function Gu(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=e.readable===!1,e.endEmitted=e.readable===!1),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=t.writable===!1,t.ending=t.writable===!1,t.finished=t.writable===!1)}function ho(e,t,r){const n=e._readableState,o=e._writableState;if(o!=null&&o.destroyed||n!=null&&n.destroyed)return this;n!=null&&n.autoDestroy||o!=null&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),n&&!n.errored&&(n.errored=t),r?Ge.nextTick(fo,e,t):fo(e,t))}function Ku(e,t){if(typeof e._construct!="function")return;const r=e._readableState,n=e._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),e.once(co,t),!(e.listenerCount(co)>1)&&Ge.nextTick(Ju,e)}function Ju(e){let t=!1;function r(n){if(t){ho(e,n??new Uu);return}t=!0;const o=e._readableState,i=e._writableState,s=i||o;o&&(o.constructed=!0),i&&(i.constructed=!0),s.destroyed?e.emit(Ks,n):n?ho(e,n,!0):Ge.nextTick(Zu,e)}try{e._construct(n=>{Ge.nextTick(r,n)})}catch(n){Ge.nextTick(r,n)}}function Zu(e){e.emit(co)}function Ai(e){return(e==null?void 0:e.setHeader)&&typeof e.abort=="function"}function Ys(e){e.emit("close")}function Yu(e,t){e.emit("error",t),Ge.nextTick(Ys,e)}function Qu(e,t){!e||$u(e)||(!t&&!qu(e)&&(t=new Wu),Hu(e)?(e.socket=null,e.destroy(t)):Ai(e)?e.abort():Ai(e.req)?e.req.abort():typeof e.destroy=="function"?e.destroy(t):typeof e.close=="function"?e.close():t?Ge.nextTick(Yu,e,t):Ge.nextTick(Ys,e),e.destroyed||(e[Fu]=!0))}var Jt={construct:Ku,destroyer:Qu,destroy:zu,undestroy:Gu,errorOrDestroy:ho};const{ArrayIsArray:Xu,ObjectSetPrototypeOf:Qs}=fe,{EventEmitter:sn}=yr;function an(e){sn.call(this,e)}Qs(an.prototype,sn.prototype);Qs(an,sn);an.prototype.pipe=function(e,t){const r=this;function n(p){e.writable&&e.write(p)===!1&&r.pause&&r.pause()}r.on("data",n);function o(){r.readable&&r.resume&&r.resume()}e.on("drain",o),!e._isStdio&&(!t||t.end!==!1)&&(r.on("end",s),r.on("close",u));let i=!1;function s(){i||(i=!0,e.end())}function u(){i||(i=!0,typeof e.destroy=="function"&&e.destroy())}function l(p){c(),sn.listenerCount(this,"error")===0&&this.emit("error",p)}po(r,"error",l),po(e,"error",l);function c(){r.removeListener("data",n),e.removeListener("drain",o),r.removeListener("end",s),r.removeListener("close",u),r.removeListener("error",l),e.removeListener("error",l),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e};function po(e,t,r){if(typeof e.prependListener=="function")return e.prependListener(t,r);!e._events||!e._events[t]?e.on(t,r):Xu(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]}var ko={Stream:an,prependListener:po},Xs={exports:{}};(function(e){const{SymbolDispose:t}=fe,{AbortError:r,codes:n}=Ie,{isNodeStream:o,isWebStream:i,kControllerErrorFunction:s}=lt,u=gt,{ERR_INVALID_ARG_TYPE:l}=n;let c;const p=(y,g)=>{if(typeof y!="object"||!("aborted"in y))throw new l(g,"AbortSignal",y)};e.exports.addAbortSignal=function(y,g){if(p(y,"signal"),!o(g)&&!i(g))throw new l("stream",["ReadableStream","WritableStream","Stream"],g);return e.exports.addAbortSignalNoValidate(y,g)},e.exports.addAbortSignalNoValidate=function(y,g){if(typeof y!="object"||!("aborted"in y))return g;const A=o(g)?()=>{g.destroy(new r(void 0,{cause:y.reason}))}:()=>{g[s](new r(void 0,{cause:y.reason}))};if(y.aborted)A();else{c=c||je.addAbortListener;const R=c(y,A);u(g,R[t])}return g}})(Xs);var ln=Xs.exports;const{StringPrototypeSlice:Ri,SymbolIterator:ec,TypedArrayPrototypeSet:Mr,Uint8Array:tc}=fe,{Buffer:Dn}=xt,{inspect:rc}=je;var nc=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};this.length===0&&(this.tail=t),this.head=t,++this.length}shift(){if(this.length===0)return;const e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let t=this.head,r=""+t.data;for(;(t=t.next)!==null;)r+=e+t.data;return r}concat(e){if(this.length===0)return Dn.alloc(0);const t=Dn.allocUnsafe(e>>>0);let r=this.head,n=0;for(;r;)Mr(t,r.data,n),n+=r.data.length,r=r.next;return t}consume(e,t){const r=this.head.data;if(e<r.length){const n=r.slice(0,e);return this.head.data=r.slice(e),n}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[ec](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,n=0;do{const o=r.data;if(e>o.length)t+=o,e-=o.length;else{e===o.length?(t+=o,++n,r.next?this.head=r.next:this.head=this.tail=null):(t+=Ri(o,0,e),this.head=r,r.data=Ri(o,e));break}++n}while((r=r.next)!==null);return this.length-=n,t}_getBuffer(e){const t=Dn.allocUnsafe(e),r=e;let n=this.head,o=0;do{const i=n.data;if(e>i.length)Mr(t,i,r-e),e-=i.length;else{e===i.length?(Mr(t,i,r-e),++o,n.next?this.head=n.next:this.head=this.tail=null):(Mr(t,new tc(i.buffer,i.byteOffset,e),r-e),this.head=n,n.data=i.slice(e));break}++o}while((n=n.next)!==null);return this.length-=o,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return rc(this,{...t,depth:0,customInspect:!1})}};const{MathFloor:oc,NumberIsInteger:ic}=fe,{validateInteger:sc}=wr,{ERR_INVALID_ARG_VALUE:ac}=Ie.codes;let ea=16*1024,ta=16;function lc(e,t,r){return e.highWaterMark!=null?e.highWaterMark:t?e[r]:null}function ra(e){return e?ta:ea}function uc(e,t){sc(t,"value",0),e?ta=t:ea=t}function cc(e,t,r,n){const o=lc(t,n,r);if(o!=null){if(!ic(o)||o<0){const i=n?`options.${r}`:"options.highWaterMark";throw new ac(i,o)}return oc(o)}return ra(e.objectMode)}var un={getHighWaterMark:cc,getDefaultHighWaterMark:ra,setDefaultHighWaterMark:uc};const Ii=Nt,{PromisePrototypeThen:dc,SymbolAsyncIterator:Ti,SymbolIterator:Oi}=fe,{Buffer:fc}=xt,{ERR_INVALID_ARG_TYPE:hc,ERR_STREAM_NULL_VALUES:pc}=Ie.codes;function gc(e,t,r){let n;if(typeof t=="string"||t instanceof fc)return new e({objectMode:!0,...r,read(){this.push(t),this.push(null)}});let o;if(t&&t[Ti])o=!0,n=t[Ti]();else if(t&&t[Oi])o=!1,n=t[Oi]();else throw new hc("iterable",["Iterable"],t);const i=new e({objectMode:!0,highWaterMark:1,...r});let s=!1;i._read=function(){s||(s=!0,l())},i._destroy=function(c,p){dc(u(c),()=>Ii.nextTick(p,c),y=>Ii.nextTick(p,y||c))};async function u(c){const p=c!=null,y=typeof n.throw=="function";if(p&&y){const{value:g,done:A}=await n.throw(c);if(await g,A)return}if(typeof n.return=="function"){const{value:g}=await n.return();await g}}async function l(){for(;;){try{const{value:c,done:p}=o?await n.next():n.next();if(p)i.push(null);else{const y=c&&typeof c.then=="function"?await c:c;if(y===null)throw s=!1,new pc;if(i.push(y))continue;s=!1}}catch(c){i.destroy(c)}break}}return i}var na=gc,Un,Pi;function cn(){if(Pi)return Un;Pi=1;const e=Nt,{ArrayPrototypeIndexOf:t,NumberIsInteger:r,NumberIsNaN:n,NumberParseInt:o,ObjectDefineProperties:i,ObjectKeys:s,ObjectSetPrototypeOf:u,Promise:l,SafeSet:c,SymbolAsyncDispose:p,SymbolAsyncIterator:y,Symbol:g}=fe;Un=K,K.ReadableState=Ne;const{EventEmitter:A}=yr,{Stream:R,prependListener:h}=ko,{Buffer:b}=xt,{addAbortSignal:_}=ln,T=gt;let S=je.debuglog("stream",a=>{S=a});const F=nc,k=Jt,{getHighWaterMark:C,getDefaultHighWaterMark:H}=un,{aggregateTwoErrors:U,codes:{ERR_INVALID_ARG_TYPE:Q,ERR_METHOD_NOT_IMPLEMENTED:Z,ERR_OUT_OF_RANGE:B,ERR_STREAM_PUSH_AFTER_EOF:D,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:N},AbortError:X}=Ie,{validateObject:I}=wr,x=g("kPaused"),{StringDecoder:M}=El(),J=na;u(K.prototype,R.prototype),u(K,R);const Y=()=>{},{errorOrDestroy:G}=k,ee=1,he=2,L=4,oe=8,ge=16,we=32,_e=64,Ee=128,Ae=256,Pe=512,xe=1024,be=2048,w=4096,v=8192,O=16384,$=32768,V=65536,ie=1<<17,ue=1<<18;function re(a){return{enumerable:!1,get(){return(this.state&a)!==0},set(f){f?this.state|=a:this.state&=~a}}}i(Ne.prototype,{objectMode:re(ee),ended:re(he),endEmitted:re(L),reading:re(oe),constructed:re(ge),sync:re(we),needReadable:re(_e),emittedReadable:re(Ee),readableListening:re(Ae),resumeScheduled:re(Pe),errorEmitted:re(xe),emitClose:re(be),autoDestroy:re(w),destroyed:re(v),closed:re(O),closeEmitted:re($),multiAwaitDrain:re(V),readingMore:re(ie),dataEmitted:re(ue)});function Ne(a,f,P){typeof P!="boolean"&&(P=f instanceof st()),this.state=be|w|ge|we,a&&a.objectMode&&(this.state|=ee),P&&a&&a.readableObjectMode&&(this.state|=ee),this.highWaterMark=a?C(this,a,"readableHighWaterMark",P):H(!1),this.buffer=new F,this.length=0,this.pipes=[],this.flowing=null,this[x]=null,a&&a.emitClose===!1&&(this.state&=-2049),a&&a.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=a&&a.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,a&&a.encoding&&(this.decoder=new M(a.encoding),this.encoding=a.encoding)}function K(a){if(!(this instanceof K))return new K(a);const f=this instanceof st();this._readableState=new Ne(a,this,f),a&&(typeof a.read=="function"&&(this._read=a.read),typeof a.destroy=="function"&&(this._destroy=a.destroy),typeof a.construct=="function"&&(this._construct=a.construct),a.signal&&!f&&_(a.signal,this)),R.call(this,a),k.construct(this,()=>{this._readableState.needReadable&&mt(this,this._readableState)})}K.prototype.destroy=k.destroy,K.prototype._undestroy=k.undestroy,K.prototype._destroy=function(a,f){f(a)},K.prototype[A.captureRejectionSymbol]=function(a){this.destroy(a)},K.prototype[p]=function(){let a;return this.destroyed||(a=this.readableEnded?null:new X,this.destroy(a)),new l((f,P)=>T(this,j=>j&&j!==a?P(j):f(null)))},K.prototype.push=function(a,f){return ve(this,a,f,!1)},K.prototype.unshift=function(a,f){return ve(this,a,f,!0)};function ve(a,f,P,j){S("readableAddChunk",f);const W=a._readableState;let me;if(W.state&ee||(typeof f=="string"?(P=P||W.defaultEncoding,W.encoding!==P&&(j&&W.encoding?f=b.from(f,P).toString(W.encoding):(f=b.from(f,P),P=""))):f instanceof b?P="":R._isUint8Array(f)?(f=R._uint8ArrayToBuffer(f),P=""):f!=null&&(me=new Q("chunk",["string","Buffer","Uint8Array"],f))),me)G(a,me);else if(f===null)W.state&=-9,Bt(a,W);else if(W.state&ee||f&&f.length>0)if(j)if(W.state&L)G(a,new N);else{if(W.destroyed||W.errored)return!1;Ct(a,W,f,!0)}else if(W.ended)G(a,new D);else{if(W.destroyed||W.errored)return!1;W.state&=-9,W.decoder&&!P?(f=W.decoder.write(f),W.objectMode||f.length!==0?Ct(a,W,f,!1):mt(a,W)):Ct(a,W,f,!1)}else j||(W.state&=-9,mt(a,W));return!W.ended&&(W.length<W.highWaterMark||W.length===0)}function Ct(a,f,P,j){f.flowing&&f.length===0&&!f.sync&&a.listenerCount("data")>0?(f.state&V?f.awaitDrainWriters.clear():f.awaitDrainWriters=null,f.dataEmitted=!0,a.emit("data",P)):(f.length+=f.objectMode?1:P.length,j?f.buffer.unshift(P):f.buffer.push(P),f.state&_e&&bt(a)),mt(a,f)}K.prototype.isPaused=function(){const a=this._readableState;return a[x]===!0||a.flowing===!1},K.prototype.setEncoding=function(a){const f=new M(a);this._readableState.decoder=f,this._readableState.encoding=this._readableState.decoder.encoding;const P=this._readableState.buffer;let j="";for(const W of P)j+=f.write(W);return P.clear(),j!==""&&P.push(j),this._readableState.length=j.length,this};const Ar=1073741824;function _n(a){if(a>Ar)throw new B("size","<= 1GiB",a);return a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++,a}function Rr(a,f){return a<=0||f.length===0&&f.ended?0:f.state&ee?1:n(a)?f.flowing&&f.length?f.buffer.first().length:f.length:a<=f.length?a:f.ended?f.length:0}K.prototype.read=function(a){S("read",a),a===void 0?a=NaN:r(a)||(a=o(a,10));const f=this._readableState,P=a;if(a>f.highWaterMark&&(f.highWaterMark=_n(a)),a!==0&&(f.state&=-129),a===0&&f.needReadable&&((f.highWaterMark!==0?f.length>=f.highWaterMark:f.length>0)||f.ended))return S("read: emitReadable",f.length,f.ended),f.length===0&&f.ended?Xt(this):bt(this),null;if(a=Rr(a,f),a===0&&f.ended)return f.length===0&&Xt(this),null;let j=(f.state&_e)!==0;if(S("need readable",j),(f.length===0||f.length-a<f.highWaterMark)&&(j=!0,S("length less than watermark",j)),f.ended||f.reading||f.destroyed||f.errored||!f.constructed)j=!1,S("reading, ended or constructing",j);else if(j){S("do read"),f.state|=oe|we,f.length===0&&(f.state|=_e);try{this._read(f.highWaterMark)}catch(me){G(this,me)}f.state&=-33,f.reading||(a=Rr(P,f))}let W;return a>0?W=ut(a,f):W=null,W===null?(f.needReadable=f.length<=f.highWaterMark,a=0):(f.length-=a,f.multiAwaitDrain?f.awaitDrainWriters.clear():f.awaitDrainWriters=null),f.length===0&&(f.ended||(f.needReadable=!0),P!==a&&f.ended&&Xt(this)),W!==null&&!f.errorEmitted&&!f.closeEmitted&&(f.dataEmitted=!0,this.emit("data",W)),W};function Bt(a,f){if(S("onEofChunk"),!f.ended){if(f.decoder){const P=f.decoder.end();P&&P.length&&(f.buffer.push(P),f.length+=f.objectMode?1:P.length)}f.ended=!0,f.sync?bt(a):(f.needReadable=!1,f.emittedReadable=!0,Yt(a))}}function bt(a){const f=a._readableState;S("emitReadable",f.needReadable,f.emittedReadable),f.needReadable=!1,f.emittedReadable||(S("emitReadable",f.flowing),f.emittedReadable=!0,e.nextTick(Yt,a))}function Yt(a){const f=a._readableState;S("emitReadable_",f.destroyed,f.length,f.ended),!f.destroyed&&!f.errored&&(f.length||f.ended)&&(a.emit("readable"),f.emittedReadable=!1),f.needReadable=!f.flowing&&!f.ended&&f.length<=f.highWaterMark,Qt(a)}function mt(a,f){!f.readingMore&&f.constructed&&(f.readingMore=!0,e.nextTick(Ir,a,f))}function Ir(a,f){for(;!f.reading&&!f.ended&&(f.length<f.highWaterMark||f.flowing&&f.length===0);){const P=f.length;if(S("maybeReadMore read 0"),a.read(0),P===f.length)break}f.readingMore=!1}K.prototype._read=function(a){throw new Z("_read()")},K.prototype.pipe=function(a,f){const P=this,j=this._readableState;j.pipes.length===1&&(j.multiAwaitDrain||(j.multiAwaitDrain=!0,j.awaitDrainWriters=new c(j.awaitDrainWriters?[j.awaitDrainWriters]:[]))),j.pipes.push(a),S("pipe count=%d opts=%j",j.pipes.length,f);const W=(!f||f.end!==!1)&&a!==e.stdout&&a!==e.stderr?Te:yt;j.endEmitted?e.nextTick(W):P.once("end",W),a.on("unpipe",me);function me(et,Fe){S("onunpipe"),et===P&&Fe&&Fe.hasUnpiped===!1&&(Fe.hasUnpiped=!0,An())}function Te(){S("onend"),a.end()}let Qe,Xe=!1;function An(){S("cleanup"),a.removeListener("close",rr),a.removeListener("finish",He),Qe&&a.removeListener("drain",Qe),a.removeListener("error",tr),a.removeListener("unpipe",me),P.removeListener("end",Te),P.removeListener("end",yt),P.removeListener("data",kr),Xe=!0,Qe&&j.awaitDrainWriters&&(!a._writableState||a._writableState.needDrain)&&Qe()}function Nr(){Xe||(j.pipes.length===1&&j.pipes[0]===a?(S("false write response, pause",0),j.awaitDrainWriters=a,j.multiAwaitDrain=!1):j.pipes.length>1&&j.pipes.includes(a)&&(S("false write response, pause",j.awaitDrainWriters.size),j.awaitDrainWriters.add(a)),P.pause()),Qe||(Qe=vn(P,a),a.on("drain",Qe))}P.on("data",kr);function kr(et){S("ondata");const Fe=a.write(et);S("dest.write",Fe),Fe===!1&&Nr()}function tr(et){if(S("onerror",et),yt(),a.removeListener("error",tr),a.listenerCount("error")===0){const Fe=a._writableState||a._readableState;Fe&&!Fe.errorEmitted?G(a,et):a.emit("error",et)}}h(a,"error",tr);function rr(){a.removeListener("finish",He),yt()}a.once("close",rr);function He(){S("onfinish"),a.removeListener("close",rr),yt()}a.once("finish",He);function yt(){S("unpipe"),P.unpipe(a)}return a.emit("pipe",P),a.writableNeedDrain===!0?Nr():j.flowing||(S("pipe resume"),P.resume()),a};function vn(a,f){return function(){const P=a._readableState;P.awaitDrainWriters===f?(S("pipeOnDrain",1),P.awaitDrainWriters=null):P.multiAwaitDrain&&(S("pipeOnDrain",P.awaitDrainWriters.size),P.awaitDrainWriters.delete(f)),(!P.awaitDrainWriters||P.awaitDrainWriters.size===0)&&a.listenerCount("data")&&a.resume()}}K.prototype.unpipe=function(a){const f=this._readableState,P={hasUnpiped:!1};if(f.pipes.length===0)return this;if(!a){const W=f.pipes;f.pipes=[],this.pause();for(let me=0;me<W.length;me++)W[me].emit("unpipe",this,{hasUnpiped:!1});return this}const j=t(f.pipes,a);return j===-1?this:(f.pipes.splice(j,1),f.pipes.length===0&&this.pause(),a.emit("unpipe",this,P),this)},K.prototype.on=function(a,f){const P=R.prototype.on.call(this,a,f),j=this._readableState;return a==="data"?(j.readableListening=this.listenerCount("readable")>0,j.flowing!==!1&&this.resume()):a==="readable"&&!j.endEmitted&&!j.readableListening&&(j.readableListening=j.needReadable=!0,j.flowing=!1,j.emittedReadable=!1,S("on readable",j.length,j.reading),j.length?bt(this):j.reading||e.nextTick(Ze,this)),P},K.prototype.addListener=K.prototype.on,K.prototype.removeListener=function(a,f){const P=R.prototype.removeListener.call(this,a,f);return a==="readable"&&e.nextTick(Tr,this),P},K.prototype.off=K.prototype.removeListener,K.prototype.removeAllListeners=function(a){const f=R.prototype.removeAllListeners.apply(this,arguments);return(a==="readable"||a===void 0)&&e.nextTick(Tr,this),f};function Tr(a){const f=a._readableState;f.readableListening=a.listenerCount("readable")>0,f.resumeScheduled&&f[x]===!1?f.flowing=!0:a.listenerCount("data")>0?a.resume():f.readableListening||(f.flowing=null)}function Ze(a){S("readable nexttick read 0"),a.read(0)}K.prototype.resume=function(){const a=this._readableState;return a.flowing||(S("resume"),a.flowing=!a.readableListening,Mt(this,a)),a[x]=!1,this};function Mt(a,f){f.resumeScheduled||(f.resumeScheduled=!0,e.nextTick(Sn,a,f))}function Sn(a,f){S("resume",f.reading),f.reading||a.read(0),f.resumeScheduled=!1,a.emit("resume"),Qt(a),f.flowing&&!f.reading&&a.read(0)}K.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[x]=!0,this};function Qt(a){const f=a._readableState;for(S("flow",f.flowing);f.flowing&&a.read()!==null;);}K.prototype.wrap=function(a){let f=!1;a.on("data",j=>{!this.push(j)&&a.pause&&(f=!0,a.pause())}),a.on("end",()=>{this.push(null)}),a.on("error",j=>{G(this,j)}),a.on("close",()=>{this.destroy()}),a.on("destroy",()=>{this.destroy()}),this._read=()=>{f&&a.resume&&(f=!1,a.resume())};const P=s(a);for(let j=1;j<P.length;j++){const W=P[j];this[W]===void 0&&typeof a[W]=="function"&&(this[W]=a[W].bind(a))}return this},K.prototype[y]=function(){return Or(this)},K.prototype.iterator=function(a){return a!==void 0&&I(a,"options"),Or(this,a)};function Or(a,f){typeof a.read!="function"&&(a=K.wrap(a,{objectMode:!0}));const P=Pr(a,f);return P.stream=a,P}async function*Pr(a,f){let P=Y;function j(Te){this===a?(P(),P=Y):P=Te}a.on("readable",j);let W;const me=T(a,{writable:!1},Te=>{W=Te?U(W,Te):null,P(),P=Y});try{for(;;){const Te=a.destroyed?null:a.read();if(Te!==null)yield Te;else{if(W)throw W;if(W===null)return;await new l(j)}}}catch(Te){throw W=U(W,Te),W}finally{(W||(f==null?void 0:f.destroyOnReturn)!==!1)&&(W===void 0||a._readableState.autoDestroy)?k.destroyer(a,null):(a.off("readable",j),me())}}i(K.prototype,{readable:{__proto__:null,get(){const a=this._readableState;return!!a&&a.readable!==!1&&!a.destroyed&&!a.errorEmitted&&!a.endEmitted},set(a){this._readableState&&(this._readableState.readable=!!a)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(a){this._readableState&&(this._readableState.flowing=a)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(a){this._readableState&&(this._readableState.destroyed=a)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Ne.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[x]!==!1},set(a){this[x]=!!a}}}),K._fromList=ut;function ut(a,f){if(f.length===0)return null;let P;return f.objectMode?P=f.buffer.shift():!a||a>=f.length?(f.decoder?P=f.buffer.join(""):f.buffer.length===1?P=f.buffer.first():P=f.buffer.concat(f.length),f.buffer.clear()):P=f.buffer.consume(a,f.decoder),P}function Xt(a){const f=a._readableState;S("endReadable",f.endEmitted),f.endEmitted||(f.ended=!0,e.nextTick(Ye,f,a))}function Ye(a,f){if(S("endReadableNT",a.endEmitted,a.length),!a.errored&&!a.closeEmitted&&!a.endEmitted&&a.length===0){if(a.endEmitted=!0,f.emit("end"),f.writable&&f.allowHalfOpen===!1)e.nextTick(En,f);else if(a.autoDestroy){const P=f._writableState;(!P||P.autoDestroy&&(P.finished||P.writable===!1))&&f.destroy()}}}function En(a){a.writable&&!a.writableEnded&&!a.destroyed&&a.end()}K.from=function(a,f){return J(K,a,f)};let er;function xr(){return er===void 0&&(er={}),er}return K.fromWeb=function(a,f){return xr().newStreamReadableFromReadableStream(a,f)},K.toWeb=function(a,f){return xr().newReadableStreamFromStreamReadable(a,f)},K.wrap=function(a,f){var P,j;return new K({objectMode:(P=(j=a.readableObjectMode)!==null&&j!==void 0?j:a.objectMode)!==null&&P!==void 0?P:!0,...f,destroy(W,me){k.destroyer(a,W),me(W)}}).wrap(a)},Un}var Wn,xi;function Lo(){if(xi)return Wn;xi=1;const e=Nt,{ArrayPrototypeSlice:t,Error:r,FunctionPrototypeSymbolHasInstance:n,ObjectDefineProperty:o,ObjectDefineProperties:i,ObjectSetPrototypeOf:s,StringPrototypeToLowerCase:u,Symbol:l,SymbolHasInstance:c}=fe;Wn=I,I.WritableState=N;const{EventEmitter:p}=yr,y=ko.Stream,{Buffer:g}=xt,A=Jt,{addAbortSignal:R}=ln,{getHighWaterMark:h,getDefaultHighWaterMark:b}=un,{ERR_INVALID_ARG_TYPE:_,ERR_METHOD_NOT_IMPLEMENTED:T,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:F,ERR_STREAM_DESTROYED:k,ERR_STREAM_ALREADY_FINISHED:C,ERR_STREAM_NULL_VALUES:H,ERR_STREAM_WRITE_AFTER_END:U,ERR_UNKNOWN_ENCODING:Q}=Ie.codes,{errorOrDestroy:Z}=A;s(I.prototype,y.prototype),s(I,y);function B(){}const D=l("kOnFinished");function N(w,v,O){typeof O!="boolean"&&(O=v instanceof st()),this.objectMode=!!(w&&w.objectMode),O&&(this.objectMode=this.objectMode||!!(w&&w.writableObjectMode)),this.highWaterMark=w?h(this,w,"writableHighWaterMark",O):b(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const $=!!(w&&w.decodeStrings===!1);this.decodeStrings=!$,this.defaultEncoding=w&&w.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=G.bind(void 0,v),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,X(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!w||w.emitClose!==!1,this.autoDestroy=!w||w.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[D]=[]}function X(w){w.buffered=[],w.bufferedIndex=0,w.allBuffers=!0,w.allNoop=!0}N.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},o(N.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function I(w){const v=this instanceof st();if(!v&&!n(I,this))return new I(w);this._writableState=new N(w,this,v),w&&(typeof w.write=="function"&&(this._write=w.write),typeof w.writev=="function"&&(this._writev=w.writev),typeof w.destroy=="function"&&(this._destroy=w.destroy),typeof w.final=="function"&&(this._final=w.final),typeof w.construct=="function"&&(this._construct=w.construct),w.signal&&R(w.signal,this)),y.call(this,w),A.construct(this,()=>{const O=this._writableState;O.writing||oe(this,O),Ee(this,O)})}o(I,c,{__proto__:null,value:function(w){return n(this,w)?!0:this!==I?!1:w&&w._writableState instanceof N}}),I.prototype.pipe=function(){Z(this,new F)};function x(w,v,O,$){const V=w._writableState;if(typeof O=="function")$=O,O=V.defaultEncoding;else{if(!O)O=V.defaultEncoding;else if(O!=="buffer"&&!g.isEncoding(O))throw new Q(O);typeof $!="function"&&($=B)}if(v===null)throw new H;if(!V.objectMode)if(typeof v=="string")V.decodeStrings!==!1&&(v=g.from(v,O),O="buffer");else if(v instanceof g)O="buffer";else if(y._isUint8Array(v))v=y._uint8ArrayToBuffer(v),O="buffer";else throw new _("chunk",["string","Buffer","Uint8Array"],v);let ie;return V.ending?ie=new U:V.destroyed&&(ie=new k("write")),ie?(e.nextTick($,ie),Z(w,ie,!0),ie):(V.pendingcb++,M(w,V,v,O,$))}I.prototype.write=function(w,v,O){return x(this,w,v,O)===!0},I.prototype.cork=function(){this._writableState.corked++},I.prototype.uncork=function(){const w=this._writableState;w.corked&&(w.corked--,w.writing||oe(this,w))},I.prototype.setDefaultEncoding=function(w){if(typeof w=="string"&&(w=u(w)),!g.isEncoding(w))throw new Q(w);return this._writableState.defaultEncoding=w,this};function M(w,v,O,$,V){const ie=v.objectMode?1:O.length;v.length+=ie;const ue=v.length<v.highWaterMark;return ue||(v.needDrain=!0),v.writing||v.corked||v.errored||!v.constructed?(v.buffered.push({chunk:O,encoding:$,callback:V}),v.allBuffers&&$!=="buffer"&&(v.allBuffers=!1),v.allNoop&&V!==B&&(v.allNoop=!1)):(v.writelen=ie,v.writecb=V,v.writing=!0,v.sync=!0,w._write(O,$,v.onwrite),v.sync=!1),ue&&!v.errored&&!v.destroyed}function J(w,v,O,$,V,ie,ue){v.writelen=$,v.writecb=ue,v.writing=!0,v.sync=!0,v.destroyed?v.onwrite(new k("write")):O?w._writev(V,v.onwrite):w._write(V,ie,v.onwrite),v.sync=!1}function Y(w,v,O,$){--v.pendingcb,$(O),L(v),Z(w,O)}function G(w,v){const O=w._writableState,$=O.sync,V=O.writecb;if(typeof V!="function"){Z(w,new S);return}O.writing=!1,O.writecb=null,O.length-=O.writelen,O.writelen=0,v?(v.stack,O.errored||(O.errored=v),w._readableState&&!w._readableState.errored&&(w._readableState.errored=v),$?e.nextTick(Y,w,O,v,V):Y(w,O,v,V)):(O.buffered.length>O.bufferedIndex&&oe(w,O),$?O.afterWriteTickInfo!==null&&O.afterWriteTickInfo.cb===V?O.afterWriteTickInfo.count++:(O.afterWriteTickInfo={count:1,cb:V,stream:w,state:O},e.nextTick(ee,O.afterWriteTickInfo)):he(w,O,1,V))}function ee({stream:w,state:v,count:O,cb:$}){return v.afterWriteTickInfo=null,he(w,v,O,$)}function he(w,v,O,$){for(!v.ending&&!w.destroyed&&v.length===0&&v.needDrain&&(v.needDrain=!1,w.emit("drain"));O-- >0;)v.pendingcb--,$();v.destroyed&&L(v),Ee(w,v)}function L(w){if(w.writing)return;for(let V=w.bufferedIndex;V<w.buffered.length;++V){var v;const{chunk:ie,callback:ue}=w.buffered[V],re=w.objectMode?1:ie.length;w.length-=re,ue((v=w.errored)!==null&&v!==void 0?v:new k("write"))}const O=w[D].splice(0);for(let V=0;V<O.length;V++){var $;O[V](($=w.errored)!==null&&$!==void 0?$:new k("end"))}X(w)}function oe(w,v){if(v.corked||v.bufferProcessing||v.destroyed||!v.constructed)return;const{buffered:O,bufferedIndex:$,objectMode:V}=v,ie=O.length-$;if(!ie)return;let ue=$;if(v.bufferProcessing=!0,ie>1&&w._writev){v.pendingcb-=ie-1;const re=v.allNoop?B:K=>{for(let ve=ue;ve<O.length;++ve)O[ve].callback(K)},Ne=v.allNoop&&ue===0?O:t(O,ue);Ne.allBuffers=v.allBuffers,J(w,v,!0,v.length,Ne,"",re),X(v)}else{do{const{chunk:re,encoding:Ne,callback:K}=O[ue];O[ue++]=null;const ve=V?1:re.length;J(w,v,!1,ve,re,Ne,K)}while(ue<O.length&&!v.writing);ue===O.length?X(v):ue>256?(O.splice(0,ue),v.bufferedIndex=0):v.bufferedIndex=ue}v.bufferProcessing=!1}I.prototype._write=function(w,v,O){if(this._writev)this._writev([{chunk:w,encoding:v}],O);else throw new T("_write()")},I.prototype._writev=null,I.prototype.end=function(w,v,O){const $=this._writableState;typeof w=="function"?(O=w,w=null,v=null):typeof v=="function"&&(O=v,v=null);let V;if(w!=null){const ie=x(this,w,v);ie instanceof r&&(V=ie)}return $.corked&&($.corked=1,this.uncork()),V||(!$.errored&&!$.ending?($.ending=!0,Ee(this,$,!0),$.ended=!0):$.finished?V=new C("end"):$.destroyed&&(V=new k("end"))),typeof O=="function"&&(V||$.finished?e.nextTick(O,V):$[D].push(O)),this};function ge(w){return w.ending&&!w.destroyed&&w.constructed&&w.length===0&&!w.errored&&w.buffered.length===0&&!w.finished&&!w.writing&&!w.errorEmitted&&!w.closeEmitted}function we(w,v){let O=!1;function $(V){if(O){Z(w,V??S());return}if(O=!0,v.pendingcb--,V){const ie=v[D].splice(0);for(let ue=0;ue<ie.length;ue++)ie[ue](V);Z(w,V,v.sync)}else ge(v)&&(v.prefinished=!0,w.emit("prefinish"),v.pendingcb++,e.nextTick(Ae,w,v))}v.sync=!0,v.pendingcb++;try{w._final($)}catch(V){$(V)}v.sync=!1}function _e(w,v){!v.prefinished&&!v.finalCalled&&(typeof w._final=="function"&&!v.destroyed?(v.finalCalled=!0,we(w,v)):(v.prefinished=!0,w.emit("prefinish")))}function Ee(w,v,O){ge(v)&&(_e(w,v),v.pendingcb===0&&(O?(v.pendingcb++,e.nextTick(($,V)=>{ge(V)?Ae($,V):V.pendingcb--},w,v)):ge(v)&&(v.pendingcb++,Ae(w,v))))}function Ae(w,v){v.pendingcb--,v.finished=!0;const O=v[D].splice(0);for(let $=0;$<O.length;$++)O[$]();if(w.emit("finish"),v.autoDestroy){const $=w._readableState;(!$||$.autoDestroy&&($.endEmitted||$.readable===!1))&&w.destroy()}}i(I.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(w){this._writableState&&(this._writableState.destroyed=w)}},writable:{__proto__:null,get(){const w=this._writableState;return!!w&&w.writable!==!1&&!w.destroyed&&!w.errored&&!w.ending&&!w.ended},set(w){this._writableState&&(this._writableState.writable=!!w)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const w=this._writableState;return w?!w.destroyed&&!w.ending&&w.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Pe=A.destroy;I.prototype.destroy=function(w,v){const O=this._writableState;return!O.destroyed&&(O.bufferedIndex<O.buffered.length||O[D].length)&&e.nextTick(L,O),Pe.call(this,w,v),this},I.prototype._undestroy=A.undestroy,I.prototype._destroy=function(w,v){v(w)},I.prototype[p.captureRejectionSymbol]=function(w){this.destroy(w)};let xe;function be(){return xe===void 0&&(xe={}),xe}return I.fromWeb=function(w,v){return be().newStreamWritableFromWritableStream(w,v)},I.toWeb=function(w){return be().newWritableStreamFromStreamWritable(w)},Wn}var Fn,Ni;function bc(){if(Ni)return Fn;Ni=1;const e=Nt,t=xt,{isReadable:r,isWritable:n,isIterable:o,isNodeStream:i,isReadableNodeStream:s,isWritableNodeStream:u,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:p}=lt,y=gt,{AbortError:g,codes:{ERR_INVALID_ARG_TYPE:A,ERR_INVALID_RETURN_VALUE:R}}=Ie,{destroyer:h}=Jt,b=st(),_=cn(),T=Lo(),{createDeferredPromise:S}=je,F=na,k=globalThis.Blob||t.Blob,C=typeof k<"u"?function(D){return D instanceof k}:function(D){return!1},H=globalThis.AbortController||gr().AbortController,{FunctionPrototypeCall:U}=fe;class Q extends b{constructor(N){super(N),(N==null?void 0:N.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(N==null?void 0:N.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}Fn=function D(N,X){if(l(N))return N;if(s(N))return B({readable:N});if(u(N))return B({writable:N});if(i(N))return B({writable:!1,readable:!1});if(c(N))return B({readable:_.fromWeb(N)});if(p(N))return B({writable:T.fromWeb(N)});if(typeof N=="function"){const{value:x,write:M,final:J,destroy:Y}=Z(N);if(o(x))return F(Q,x,{objectMode:!0,write:M,final:J,destroy:Y});const G=x==null?void 0:x.then;if(typeof G=="function"){let ee;const he=U(G,x,L=>{if(L!=null)throw new R("nully","body",L)},L=>{h(ee,L)});return ee=new Q({objectMode:!0,readable:!1,write:M,final(L){J(async()=>{try{await he,e.nextTick(L,null)}catch(oe){e.nextTick(L,oe)}})},destroy:Y})}throw new R("Iterable, AsyncIterable or AsyncFunction",X,x)}if(C(N))return D(N.arrayBuffer());if(o(N))return F(Q,N,{objectMode:!0,writable:!1});if(c(N==null?void 0:N.readable)&&p(N==null?void 0:N.writable))return Q.fromWeb(N);if(typeof(N==null?void 0:N.writable)=="object"||typeof(N==null?void 0:N.readable)=="object"){const x=N!=null&&N.readable?s(N==null?void 0:N.readable)?N==null?void 0:N.readable:D(N.readable):void 0,M=N!=null&&N.writable?u(N==null?void 0:N.writable)?N==null?void 0:N.writable:D(N.writable):void 0;return B({readable:x,writable:M})}const I=N==null?void 0:N.then;if(typeof I=="function"){let x;return U(I,N,M=>{M!=null&&x.push(M),x.push(null)},M=>{h(x,M)}),x=new Q({objectMode:!0,writable:!1,read(){}})}throw new A(X,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],N)};function Z(D){let{promise:N,resolve:X}=S();const I=new H,x=I.signal;return{value:D(async function*(){for(;;){const M=N;N=null;const{chunk:J,done:Y,cb:G}=await M;if(e.nextTick(G),Y)return;if(x.aborted)throw new g(void 0,{cause:x.reason});({promise:N,resolve:X}=S()),yield J}}(),{signal:x}),write(M,J,Y){const G=X;X=null,G({chunk:M,done:!1,cb:Y})},final(M){const J=X;X=null,J({done:!0,cb:M})},destroy(M,J){I.abort(),J(M)}}}function B(D){const N=D.readable&&typeof D.readable.read!="function"?_.wrap(D.readable):D.readable,X=D.writable;let I=!!r(N),x=!!n(X),M,J,Y,G,ee;function he(L){const oe=G;G=null,oe?oe(L):L&&ee.destroy(L)}return ee=new Q({readableObjectMode:!!(N!=null&&N.readableObjectMode),writableObjectMode:!!(X!=null&&X.writableObjectMode),readable:I,writable:x}),x&&(y(X,L=>{x=!1,L&&h(N,L),he(L)}),ee._write=function(L,oe,ge){X.write(L,oe)?ge():M=ge},ee._final=function(L){X.end(),J=L},X.on("drain",function(){if(M){const L=M;M=null,L()}}),X.on("finish",function(){if(J){const L=J;J=null,L()}})),I&&(y(N,L=>{I=!1,L&&h(N,L),he(L)}),N.on("readable",function(){if(Y){const L=Y;Y=null,L()}}),N.on("end",function(){ee.push(null)}),ee._read=function(){for(;;){const L=N.read();if(L===null){Y=ee._read;return}if(!ee.push(L))return}}),ee._destroy=function(L,oe){!L&&G!==null&&(L=new g),Y=null,M=null,J=null,G===null?oe(L):(G=oe,h(X,L),h(N,L))},ee}return Fn}var $n,ki;function st(){if(ki)return $n;ki=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:r,ObjectSetPrototypeOf:n}=fe;$n=s;const o=cn(),i=Lo();n(s.prototype,o.prototype),n(s,o);{const p=r(i.prototype);for(let y=0;y<p.length;y++){const g=p[y];s.prototype[g]||(s.prototype[g]=i.prototype[g])}}function s(p){if(!(this instanceof s))return new s(p);o.call(this,p),i.call(this,p),p?(this.allowHalfOpen=p.allowHalfOpen!==!1,p.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),p.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(s.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(p){this._readableState&&this._writableState&&(this._readableState.destroyed=p,this._writableState.destroyed=p)}}});let u;function l(){return u===void 0&&(u={}),u}s.fromWeb=function(p,y){return l().newStreamDuplexFromReadableWritablePair(p,y)},s.toWeb=function(p){return l().newReadableWritablePairFromDuplex(p)};let c;return s.from=function(p){return c||(c=bc()),c(p,"body")},$n}const{ObjectSetPrototypeOf:oa,Symbol:mc}=fe;var ia=at;const{ERR_METHOD_NOT_IMPLEMENTED:yc}=Ie.codes,jo=st(),{getHighWaterMark:wc}=un;oa(at.prototype,jo.prototype);oa(at,jo);const dr=mc("kCallback");function at(e){if(!(this instanceof at))return new at(e);const t=e?wc(this,e,"readableHighWaterMark",!0):null;t===0&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),jo.call(this,e),this._readableState.sync=!1,this[dr]=null,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",_c)}function go(e){typeof this._flush=="function"&&!this.destroyed?this._flush((t,r)=>{if(t){e?e(t):this.destroy(t);return}r!=null&&this.push(r),this.push(null),e&&e()}):(this.push(null),e&&e())}function _c(){this._final!==go&&go.call(this)}at.prototype._final=go;at.prototype._transform=function(e,t,r){throw new yc("_transform()")};at.prototype._write=function(e,t,r){const n=this._readableState,o=this._writableState,i=n.length;this._transform(e,t,(s,u)=>{if(s){r(s);return}u!=null&&this.push(u),o.ended||i===n.length||n.length<n.highWaterMark?r():this[dr]=r})};at.prototype._read=function(){if(this[dr]){const e=this[dr];this[dr]=null,e()}};const{ObjectSetPrototypeOf:sa}=fe;var aa=Ht;const Co=ia;sa(Ht.prototype,Co.prototype);sa(Ht,Co);function Ht(e){if(!(this instanceof Ht))return new Ht(e);Co.call(this,e)}Ht.prototype._transform=function(e,t,r){r(null,e)};const ur=Nt,{ArrayIsArray:vc,Promise:Sc,SymbolAsyncIterator:Ec,SymbolDispose:Ac}=fe,Zr=gt,{once:Rc}=je,Ic=Jt,Li=st(),{aggregateTwoErrors:Tc,codes:{ERR_INVALID_ARG_TYPE:bo,ERR_INVALID_RETURN_VALUE:qn,ERR_MISSING_ARGS:Oc,ERR_STREAM_DESTROYED:Pc,ERR_STREAM_PREMATURE_CLOSE:xc},AbortError:Nc}=Ie,{validateFunction:kc,validateAbortSignal:Lc}=wr,{isIterable:vt,isReadable:Hn,isReadableNodeStream:zr,isNodeStream:ji,isTransformStream:Dt,isWebStream:jc,isReadableStream:zn,isReadableFinished:Cc}=lt,Bc=globalThis.AbortController||gr().AbortController;let Vn,Gn,Kn;function Ci(e,t,r){let n=!1;e.on("close",()=>{n=!0});const o=Zr(e,{readable:t,writable:r},i=>{n=!i});return{destroy:i=>{n||(n=!0,Ic.destroyer(e,i||new Pc("pipe")))},cleanup:o}}function Mc(e){return kc(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function Jn(e){if(vt(e))return e;if(zr(e))return Dc(e);throw new bo("val",["Readable","Iterable","AsyncIterable"],e)}async function*Dc(e){Gn||(Gn=cn()),yield*Gn.prototype[Ec].call(e)}async function Dr(e,t,r,{end:n}){let o,i=null;const s=c=>{if(c&&(o=c),i){const p=i;i=null,p()}},u=()=>new Sc((c,p)=>{o?p(o):i=()=>{o?p(o):c()}});t.on("drain",s);const l=Zr(t,{readable:!1},s);try{t.writableNeedDrain&&await u();for await(const c of e)t.write(c)||await u();n&&(t.end(),await u()),r()}catch(c){r(o!==c?Tc(o,c):c)}finally{l(),t.off("drain",s)}}async function Zn(e,t,r,{end:n}){Dt(t)&&(t=t.writable);const o=t.getWriter();try{for await(const i of e)await o.ready,o.write(i).catch(()=>{});await o.ready,n&&await o.close(),r()}catch(i){try{await o.abort(i),r(i)}catch(s){r(s)}}}function Uc(...e){return la(e,Rc(Mc(e)))}function la(e,t,r){if(e.length===1&&vc(e[0])&&(e=e[0]),e.length<2)throw new Oc("streams");const n=new Bc,o=n.signal,i=r==null?void 0:r.signal,s=[];Lc(i,"options.signal");function u(){R(new Nc)}Kn=Kn||je.addAbortListener;let l;i&&(l=Kn(i,u));let c,p;const y=[];let g=0;function A(T){R(T,--g===0)}function R(T,S){var F;if(T&&(!c||c.code==="ERR_STREAM_PREMATURE_CLOSE")&&(c=T),!(!c&&!S)){for(;y.length;)y.shift()(c);(F=l)===null||F===void 0||F[Ac](),n.abort(),S&&(c||s.forEach(k=>k()),ur.nextTick(t,c,p))}}let h;for(let T=0;T<e.length;T++){const S=e[T],F=T<e.length-1,k=T>0,C=F||(r==null?void 0:r.end)!==!1,H=T===e.length-1;if(ji(S)){let U=function(Q){Q&&Q.name!=="AbortError"&&Q.code!=="ERR_STREAM_PREMATURE_CLOSE"&&A(Q)};if(C){const{destroy:Q,cleanup:Z}=Ci(S,F,k);y.push(Q),Hn(S)&&H&&s.push(Z)}S.on("error",U),Hn(S)&&H&&s.push(()=>{S.removeListener("error",U)})}if(T===0)if(typeof S=="function"){if(h=S({signal:o}),!vt(h))throw new qn("Iterable, AsyncIterable or Stream","source",h)}else vt(S)||zr(S)||Dt(S)?h=S:h=Li.from(S);else if(typeof S=="function"){if(Dt(h)){var b;h=Jn((b=h)===null||b===void 0?void 0:b.readable)}else h=Jn(h);if(h=S(h,{signal:o}),F){if(!vt(h,!0))throw new qn("AsyncIterable",`transform[${T-1}]`,h)}else{var _;Vn||(Vn=aa);const U=new Vn({objectMode:!0}),Q=(_=h)===null||_===void 0?void 0:_.then;if(typeof Q=="function")g++,Q.call(h,D=>{p=D,D!=null&&U.write(D),C&&U.end(),ur.nextTick(A)},D=>{U.destroy(D),ur.nextTick(A,D)});else if(vt(h,!0))g++,Dr(h,U,A,{end:C});else if(zn(h)||Dt(h)){const D=h.readable||h;g++,Dr(D,U,A,{end:C})}else throw new qn("AsyncIterable or Promise","destination",h);h=U;const{destroy:Z,cleanup:B}=Ci(h,!1,!0);y.push(Z),H&&s.push(B)}}else if(ji(S)){if(zr(h)){g+=2;const U=Wc(h,S,A,{end:C});Hn(S)&&H&&s.push(U)}else if(Dt(h)||zn(h)){const U=h.readable||h;g++,Dr(U,S,A,{end:C})}else if(vt(h))g++,Dr(h,S,A,{end:C});else throw new bo("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],h);h=S}else if(jc(S)){if(zr(h))g++,Zn(Jn(h),S,A,{end:C});else if(zn(h)||vt(h))g++,Zn(h,S,A,{end:C});else if(Dt(h))g++,Zn(h.readable,S,A,{end:C});else throw new bo("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],h);h=S}else h=Li.from(S)}return(o!=null&&o.aborted||i!=null&&i.aborted)&&ur.nextTick(u),h}function Wc(e,t,r,{end:n}){let o=!1;if(t.on("close",()=>{o||r(new xc)}),e.pipe(t,{end:!1}),n){let i=function(){o=!0,t.end()};Cc(e)?ur.nextTick(i):e.once("end",i)}else r();return Zr(e,{readable:!0,writable:!1},i=>{const s=e._readableState;i&&i.code==="ERR_STREAM_PREMATURE_CLOSE"&&s&&s.ended&&!s.errored&&!s.errorEmitted?e.once("end",r).once("error",r):r(i)}),Zr(t,{readable:!1,writable:!0},r)}var Bo={pipelineImpl:la,pipeline:Uc};const{pipeline:Fc}=Bo,Ur=st(),{destroyer:$c}=Jt,{isNodeStream:Wr,isReadable:Bi,isWritable:Mi,isWebStream:Yn,isTransformStream:_t,isWritableStream:Di,isReadableStream:Ui}=lt,{AbortError:qc,codes:{ERR_INVALID_ARG_VALUE:Wi,ERR_MISSING_ARGS:Hc}}=Ie,zc=gt;var ua=function(...e){if(e.length===0)throw new Hc("streams");if(e.length===1)return Ur.from(e[0]);const t=[...e];if(typeof e[0]=="function"&&(e[0]=Ur.from(e[0])),typeof e[e.length-1]=="function"){const g=e.length-1;e[g]=Ur.from(e[g])}for(let g=0;g<e.length;++g)if(!(!Wr(e[g])&&!Yn(e[g]))){if(g<e.length-1&&!(Bi(e[g])||Ui(e[g])||_t(e[g])))throw new Wi(`streams[${g}]`,t[g],"must be readable");if(g>0&&!(Mi(e[g])||Di(e[g])||_t(e[g])))throw new Wi(`streams[${g}]`,t[g],"must be writable")}let r,n,o,i,s;function u(g){const A=i;i=null,A?A(g):g?s.destroy(g):!y&&!p&&s.destroy()}const l=e[0],c=Fc(e,u),p=!!(Mi(l)||Di(l)||_t(l)),y=!!(Bi(c)||Ui(c)||_t(c));if(s=new Ur({writableObjectMode:!!(l!=null&&l.writableObjectMode),readableObjectMode:!!(c!=null&&c.readableObjectMode),writable:p,readable:y}),p){if(Wr(l))s._write=function(A,R,h){l.write(A,R)?h():r=h},s._final=function(A){l.end(),n=A},l.on("drain",function(){if(r){const A=r;r=null,A()}});else if(Yn(l)){const A=(_t(l)?l.writable:l).getWriter();s._write=async function(R,h,b){try{await A.ready,A.write(R).catch(()=>{}),b()}catch(_){b(_)}},s._final=async function(R){try{await A.ready,A.close().catch(()=>{}),n=R}catch(h){R(h)}}}const g=_t(c)?c.readable:c;zc(g,()=>{if(n){const A=n;n=null,A()}})}if(y){if(Wr(c))c.on("readable",function(){if(o){const g=o;o=null,g()}}),c.on("end",function(){s.push(null)}),s._read=function(){for(;;){const g=c.read();if(g===null){o=s._read;return}if(!s.push(g))return}};else if(Yn(c)){const g=(_t(c)?c.readable:c).getReader();s._read=async function(){for(;;)try{const{value:A,done:R}=await g.read();if(!s.push(A))return;if(R){s.push(null);return}}catch{return}}}}return s._destroy=function(g,A){!g&&i!==null&&(g=new qc),o=null,r=null,n=null,i===null?A(g):(i=A,Wr(c)&&$c(c,g))},s};const Vc=globalThis.AbortController||gr().AbortController,{codes:{ERR_INVALID_ARG_VALUE:Gc,ERR_INVALID_ARG_TYPE:_r,ERR_MISSING_ARGS:Kc,ERR_OUT_OF_RANGE:Jc},AbortError:Ke}=Ie,{validateAbortSignal:Lt,validateInteger:Fi,validateObject:jt}=wr,Zc=fe.Symbol("kWeak"),Yc=fe.Symbol("kResistStopPropagation"),{finished:Qc}=gt,Xc=ua,{addAbortSignalNoValidate:ed}=ln,{isWritable:td,isNodeStream:rd}=lt,{deprecate:nd}=je,{ArrayPrototypePush:od,Boolean:id,MathFloor:$i,Number:sd,NumberIsNaN:ad,Promise:qi,PromiseReject:Hi,PromiseResolve:ld,PromisePrototypeThen:zi,Symbol:ca}=fe,Yr=ca("kEmpty"),Vi=ca("kEof");function ud(e,t){if(t!=null&&jt(t,"options"),(t==null?void 0:t.signal)!=null&&Lt(t.signal,"options.signal"),rd(e)&&!td(e))throw new Gc("stream",e,"must be writable");const r=Xc(this,e);return t!=null&&t.signal&&ed(t.signal,r),r}function dn(e,t){if(typeof e!="function")throw new _r("fn",["Function","AsyncFunction"],e);t!=null&&jt(t,"options"),(t==null?void 0:t.signal)!=null&&Lt(t.signal,"options.signal");let r=1;(t==null?void 0:t.concurrency)!=null&&(r=$i(t.concurrency));let n=r-1;return(t==null?void 0:t.highWaterMark)!=null&&(n=$i(t.highWaterMark)),Fi(r,"options.concurrency",1),Fi(n,"options.highWaterMark",0),n+=r,(async function*(){const o=je.AbortSignalAny([t==null?void 0:t.signal].filter(id)),i=this,s=[],u={signal:o};let l,c,p=!1,y=0;function g(){p=!0,A()}function A(){y-=1,R()}function R(){c&&!p&&y<r&&s.length<n&&(c(),c=null)}async function h(){try{for await(let b of i){if(p)return;if(o.aborted)throw new Ke;try{if(b=e(b,u),b===Yr)continue;b=ld(b)}catch(_){b=Hi(_)}y+=1,zi(b,A,g),s.push(b),l&&(l(),l=null),!p&&(s.length>=n||y>=r)&&await new qi(_=>{c=_})}s.push(Vi)}catch(b){const _=Hi(b);zi(_,A,g),s.push(_)}finally{p=!0,l&&(l(),l=null)}}h();try{for(;;){for(;s.length>0;){const b=await s[0];if(b===Vi)return;if(o.aborted)throw new Ke;b!==Yr&&(yield b),s.shift(),R()}await new qi(b=>{l=b})}}finally{p=!0,c&&(c(),c=null)}}).call(this)}function cd(e=void 0){return e!=null&&jt(e,"options"),(e==null?void 0:e.signal)!=null&&Lt(e.signal,"options.signal"),(async function*(){let t=0;for await(const n of this){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new Ke({cause:e.signal.reason});yield[t++,n]}}).call(this)}async function da(e,t=void 0){for await(const r of Mo.call(this,e,t))return!0;return!1}async function dd(e,t=void 0){if(typeof e!="function")throw new _r("fn",["Function","AsyncFunction"],e);return!await da.call(this,async(...r)=>!await e(...r),t)}async function fd(e,t){for await(const r of Mo.call(this,e,t))return r}async function hd(e,t){if(typeof e!="function")throw new _r("fn",["Function","AsyncFunction"],e);async function r(n,o){return await e(n,o),Yr}for await(const n of dn.call(this,r,t));}function Mo(e,t){if(typeof e!="function")throw new _r("fn",["Function","AsyncFunction"],e);async function r(n,o){return await e(n,o)?n:Yr}return dn.call(this,r,t)}class pd extends Kc{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function gd(e,t,r){var n;if(typeof e!="function")throw new _r("reducer",["Function","AsyncFunction"],e);r!=null&&jt(r,"options"),(r==null?void 0:r.signal)!=null&&Lt(r.signal,"options.signal");let o=arguments.length>1;if(r!=null&&(n=r.signal)!==null&&n!==void 0&&n.aborted){const c=new Ke(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await Qc(this.destroy(c)),c}const i=new Vc,s=i.signal;if(r!=null&&r.signal){const c={once:!0,[Zc]:this,[Yc]:!0};r.signal.addEventListener("abort",()=>i.abort(),c)}let u=!1;try{for await(const c of this){var l;if(u=!0,r!=null&&(l=r.signal)!==null&&l!==void 0&&l.aborted)throw new Ke;o?t=await e(t,c,{signal:s}):(t=c,o=!0)}if(!u&&!o)throw new pd}finally{i.abort()}return t}async function bd(e){e!=null&&jt(e,"options"),(e==null?void 0:e.signal)!=null&&Lt(e.signal,"options.signal");const t=[];for await(const n of this){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new Ke(void 0,{cause:e.signal.reason});od(t,n)}return t}function md(e,t){const r=dn.call(this,e,t);return(async function*(){for await(const n of r)yield*n}).call(this)}function fa(e){if(e=sd(e),ad(e))return 0;if(e<0)throw new Jc("number",">= 0",e);return e}function yd(e,t=void 0){return t!=null&&jt(t,"options"),(t==null?void 0:t.signal)!=null&&Lt(t.signal,"options.signal"),e=fa(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Ke;for await(const o of this){var n;if(t!=null&&(n=t.signal)!==null&&n!==void 0&&n.aborted)throw new Ke;e--<=0&&(yield o)}}).call(this)}function wd(e,t=void 0){return t!=null&&jt(t,"options"),(t==null?void 0:t.signal)!=null&&Lt(t.signal,"options.signal"),e=fa(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Ke;for await(const o of this){var n;if(t!=null&&(n=t.signal)!==null&&n!==void 0&&n.aborted)throw new Ke;if(e-- >0&&(yield o),e<=0)return}}).call(this)}Oo.streamReturningOperators={asIndexedPairs:nd(cd,"readable.asIndexedPairs will be removed in a future version."),drop:yd,filter:Mo,flatMap:md,map:dn,take:wd,compose:ud};Oo.promiseReturningOperators={every:dd,forEach:hd,reduce:gd,toArray:bd,some:da,find:fd};var Qn,Gi;function ha(){if(Gi)return Qn;Gi=1;const{ArrayPrototypePop:e,Promise:t}=fe,{isIterable:r,isNodeStream:n,isWebStream:o}=lt,{pipelineImpl:i}=Bo,{finished:s}=gt;pa();function u(...l){return new t((c,p)=>{let y,g;const A=l[l.length-1];if(A&&typeof A=="object"&&!n(A)&&!r(A)&&!o(A)){const R=e(l);y=R.signal,g=R.end}i(l,(R,h)=>{R?p(R):c(h)},{signal:y,end:g})})}return Qn={finished:s,pipeline:u},Qn}var Ki;function pa(){if(Ki)return Cn.exports;Ki=1;const{Buffer:e}=xt,{ObjectDefineProperty:t,ObjectKeys:r,ReflectApply:n}=fe,{promisify:{custom:o}}=je,{streamReturningOperators:i,promiseReturningOperators:s}=Oo,{codes:{ERR_ILLEGAL_CONSTRUCTOR:u}}=Ie,l=ua,{setDefaultHighWaterMark:c,getDefaultHighWaterMark:p}=un,{pipeline:y}=Bo,{destroyer:g}=Jt,A=gt,R=ha(),h=lt,b=Cn.exports=ko.Stream;b.isDestroyed=h.isDestroyed,b.isDisturbed=h.isDisturbed,b.isErrored=h.isErrored,b.isReadable=h.isReadable,b.isWritable=h.isWritable,b.Readable=cn();for(const T of r(i)){let S=function(...k){if(new.target)throw u();return b.Readable.from(n(F,this,k))};const F=i[T];t(S,"name",{__proto__:null,value:F.name}),t(S,"length",{__proto__:null,value:F.length}),t(b.Readable.prototype,T,{__proto__:null,value:S,enumerable:!1,configurable:!0,writable:!0})}for(const T of r(s)){let S=function(...k){if(new.target)throw u();return n(F,this,k)};const F=s[T];t(S,"name",{__proto__:null,value:F.name}),t(S,"length",{__proto__:null,value:F.length}),t(b.Readable.prototype,T,{__proto__:null,value:S,enumerable:!1,configurable:!0,writable:!0})}b.Writable=Lo(),b.Duplex=st(),b.Transform=ia,b.PassThrough=aa,b.pipeline=y;const{addAbortSignal:_}=ln;return b.addAbortSignal=_,b.finished=A,b.destroy=g,b.compose=l,b.setDefaultHighWaterMark=c,b.getDefaultHighWaterMark=p,t(b,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return R}}),t(y,o,{__proto__:null,enumerable:!0,get(){return R.pipeline}}),t(A,o,{__proto__:null,enumerable:!0,get(){return R.finished}}),b.Stream=b,b._isUint8Array=function(T){return T instanceof Uint8Array},b._uint8ArrayToBuffer=function(T){return e.from(T.buffer,T.byteOffset,T.byteLength)},Cn.exports}(function(e){const t=pa(),r=ha(),n=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=n,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return r}}),e.exports.Stream=t.Stream,e.exports.default=e.exports})(Ns);var fn=Ns.exports,Do={exports:{}},_d=ga;function ga(e,t){if(e&&t)return ga(e)(t);if(typeof e!="function")throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(n){r[n]=e[n]}),r;function r(){for(var n=new Array(arguments.length),o=0;o<n.length;o++)n[o]=arguments[o];var i=e.apply(this,n),s=n[n.length-1];return typeof i=="function"&&i!==s&&Object.keys(s).forEach(function(u){i[u]=s[u]}),i}}var ba=_d;Do.exports=ba(Vr);Do.exports.strict=ba(ma);Vr.proto=Vr(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Vr(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return ma(this)},configurable:!0})});function Vr(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function ma(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}var Uo=Do.exports;const vd=Kt(Uo);var Sd=Uo,Ed=function(){},Ad=function(e){return e.setHeader&&typeof e.abort=="function"},Rd=function(e){return e.stdio&&Array.isArray(e.stdio)&&e.stdio.length===3},ya=function(e,t,r){if(typeof t=="function")return ya(e,null,t);t||(t={}),r=Sd(r||Ed);var n=e._writableState,o=e._readableState,i=t.readable||t.readable!==!1&&e.readable,s=t.writable||t.writable!==!1&&e.writable,u=!1,l=function(){e.writable||c()},c=function(){s=!1,i||r.call(e)},p=function(){i=!1,s||r.call(e)},y=function(b){r.call(e,b?new Error("exited with error code: "+b):null)},g=function(b){r.call(e,b)},A=function(){Le.process.nextTick(R)},R=function(){if(!u){if(i&&!(o&&o.ended&&!o.destroyed))return r.call(e,new Error("premature close"));if(s&&!(n&&n.ended&&!n.destroyed))return r.call(e,new Error("premature close"))}},h=function(){e.req.on("finish",c)};return Ad(e)?(e.on("complete",c),e.on("abort",A),e.req?h():e.on("request",h)):s&&!n&&(e.on("end",l),e.on("close",l)),Rd(e)&&e.on("exit",y),e.on("end",p),e.on("finish",c),t.error!==!1&&e.on("error",g),e.on("close",A),function(){u=!0,e.removeListener("complete",c),e.removeListener("abort",A),e.removeListener("request",h),e.req&&e.req.removeListener("finish",c),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",c),e.removeListener("exit",y),e.removeListener("end",p),e.removeListener("error",g),e.removeListener("close",A)}},wa=ya;const Ji=Kt(wa);var Id=Uo,Td=wa,Gr;try{Gr=Sl}catch{}var br=function(){},Od=/^v?\.0/.test(Le.process.version),hn=function(e){return typeof e=="function"},Pd=function(e){return!Od||!Gr?!1:(e instanceof(Gr.ReadStream||br)||e instanceof(Gr.WriteStream||br))&&hn(e.close)},xd=function(e){return e.setHeader&&hn(e.abort)},Nd=function(e,t,r,n){n=Id(n);var o=!1;e.on("close",function(){o=!0}),Td(e,{readable:t,writable:r},function(s){if(s)return n(s);o=!0,n()});var i=!1;return function(s){if(!o&&!i){if(i=!0,Pd(e))return e.close(br);if(xd(e))return e.abort();if(hn(e.destroy))return e.destroy();n(s||new Error("stream was destroyed"))}}},Zi=function(e){e()},kd=function(e,t){return e.pipe(t)},Ld=function(){var e=Array.prototype.slice.call(arguments),t=hn(e[e.length-1]||br)&&e.pop()||br;if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Error("pump requires two streams per minimum");var r,n=e.map(function(o,i){var s=i<e.length-1,u=i>0;return Nd(o,s,u,function(l){r||(r=l),l&&n.forEach(Zi),!s&&(n.forEach(Zi),t(r))})});return e.reduce(kd)},jd=Ld;const Yi=Kt(jd);function Fr(){}const Qi="SYN",Xn="ACK",Xi="BRK";class es extends fn.Duplex{constructor(t){let{name:r,target:n,targetWindow:o=window,targetOrigin:i="*"}=t;if(super({objectMode:!0}),z(this,"_init",void 0),z(this,"_haveSyn",void 0),z(this,"_name",void 0),z(this,"_target",void 0),z(this,"_targetWindow",void 0),z(this,"_targetOrigin",void 0),z(this,"_onMessage",void 0),z(this,"_synIntervalId",void 0),!r||!n)throw new Error("Invalid input.");this._init=!1,this._haveSyn=!1,this._name=r,this._target=n,this._targetWindow=o,this._targetOrigin=i,this._onMessage=this.onMessage.bind(this),this._synIntervalId=null,window.addEventListener("message",this._onMessage,!1),this._handShake()}_break(){this.cork(),this._write(Xi,null,Fr),this._haveSyn=!1,this._init=!1}_handShake(){this._write(Qi,null,Fr),this.cork()}_onData(t){if(!this._init)t===Qi?(this._haveSyn=!0,this._write(Xn,null,Fr)):t===Xn&&(this._init=!0,this._haveSyn||this._write(Xn,null,Fr),this.uncork());else if(t===Xi)this._break();else try{this.push(t)}catch(r){this.emit("error",r)}}_postMessage(t){const r=this._targetOrigin;this._targetWindow.postMessage({target:this._target,data:t},r)}onMessage(t){const r=t.data;this._targetOrigin!=="*"&&t.origin!==this._targetOrigin||t.source!==this._targetWindow||typeof r!="object"||r.target!==this._name||!r.data||this._onData(r.data)}_read(){}_write(t,r,n){this._postMessage(t),n()}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}const Cd={rpc:{internal:-32603}},ts={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},rs=Cd.rpc.internal,Bd="Unspecified error message. This is a bug, please report it.";function _a(e){return Number.isInteger(e)}function ns(e){return typeof e=="string"&&e.length>0}function os(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function va(e){const t=e;return!(!t||!_a(t.code)||!ns(t.message)||t.stack&&!ns(t.stack))}function Md(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bd;if(_a(e)){const r=e.toString();if(Object.hasOwn(ts,r))return ts[r].message}return t}const Dd={code:rs,message:Md(rs)};function mo(e){try{JSON.parse(JSON.stringify(e,(t,r)=>{if(t==="__proto__"||t==="constructor")throw new Error("Not valid json");if(typeof r=="function"||typeof r=="symbol")throw new Error("Not valid json");return r}),(t,r)=>{if(!(t==="__proto__"||t==="constructor"))return r})}catch{return!1}return!0}function is(e){return Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return mo(n)&&(t[r]=n),t},{})}function Ud(e){return Array.isArray(e)?e.map(t=>mo(t)?t:os(t)?is(t):null):os(e)?is(e):mo(e)?e:null}function Wd(e,t){if(e&&typeof e=="object"&&"serialize"in e&&typeof e.serialize=="function")return e.serialize();if(va(e))return e;const r=Ud(e);return De(De({},t),{},{data:{cause:r}})}function ss(e){let{fallbackError:t=Dd,shouldIncludeStack:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!va(t))throw new Error("Must provide fallback error with integer number code and string message.");const n=Wd(e,t);return r||delete n.stack,n}function as(e,t,r){try{Reflect.apply(e,t,r)}catch(n){setTimeout(()=>{throw n})}}function Fd(e){const t=e.length,r=new Array(t);for(let n=0;n<t;n+=1)r[n]=e[n];return r}class pn extends yr.EventEmitter{emit(t){let r=t==="error";const n=this._events;if(n!==void 0)r=r&&n.error===void 0;else if(!r)return!1;for(var o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];if(r){let l;if(i.length>0&&([l]=i),l instanceof Error)throw l;const c=new Error(`Unhandled error.${l?` (${l.message})`:""}`);throw c.context=l,c}const u=n[t];if(u===void 0)return!1;if(typeof u=="function")as(u,this,i);else{const l=u.length,c=Fd(u);for(let p=0;p<l;p+=1)as(c[p],this,i)}return!0}}class ar extends Error{constructor(t){let{code:r,message:n,data:o}=t;if(!Number.isInteger(r))throw new Error("code must be an integer");if(!n||typeof n!="string")throw new Error("message must be string");super(n),z(this,"code",void 0),z(this,"data",void 0),this.code=r,o!==void 0&&(this.data=o)}toString(){return Rl({code:this.code,message:this.message,data:this.data,stack:this.stack})}}const yo=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(n,o)=>{n||o.error?t(n||o.error):!r||Array.isArray(o)?e(o):e(o.result)}};function $d(){const e={};function t(){return!1}const r=new pn;function n(u){const l=e[u.id];if(!l)throw new Error(`StreamMiddleware - Unknown response id "${u.id}"`);delete e[u.id],Object.assign(l.res,u),setTimeout(l.end)}function o(u){r.emit("notification",u)}function i(u,l,c){let p;try{u.id?n(u):o(u)}catch(y){p=y}c(p)}const s=new fn.Duplex({objectMode:!0,read:t,write:i});return{events:r,middleware:(u,l,c,p)=>{s.push(u),e[u.id]={req:u,res:l,next:c,end:p}},stream:s}}function qd(){return(e,t,r,n)=>{const o=e.id,i=Math.random().toString(36).slice(2);e.id=i,t.id=i,r(s=>{e.id=o,t.id=o,s()})}}class rt extends pn{constructor(){super(),z(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(t,r,n){const o=[];let i=null,s=!1;for(const u of n)if([i,s]=await rt._runMiddleware(t,r,u,o),s)break;return[i,s,o.reverse()]}static _runMiddleware(t,r,n,o){return new Promise(i=>{const s=l=>{const c=l||r.error;c&&(typeof c=="object"&&Object.keys(c).includes("stack")===!1&&(c.stack="Stack trace is not available."),r.error=ss(c,{shouldIncludeStack:!0,fallbackError:{message:(c==null?void 0:c.message)||(c==null?void 0:c.toString()),code:(c==null?void 0:c.code)||-32603,stack:(c==null?void 0:c.stack)||"Stack trace is not available.",data:(c==null?void 0:c.data)||(c==null?void 0:c.message)||(c==null?void 0:c.toString())}})),i([c,!0])},u=l=>{r.error?s(r.error):(l&&(typeof l!="function"&&s(new ar({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),o.push(l)),i([null,!1]))};try{n(t,r,u,s)}catch(l){s(l)}})}static async _runReturnHandlers(t){for(const r of t)await new Promise((n,o)=>{r(i=>i?o(i):n())})}static _checkForCompletion(t,r,n){if(!("result"in r)&&!("error"in r))throw new ar({code:-32603,message:"Response has no error or result for request"});if(!n)throw new ar({code:-32603,message:"Nothing ended request"})}push(t){this._middleware.push(t)}handle(t,r){if(r&&typeof r!="function")throw new Error('"callback" must be a function if provided.');return Array.isArray(t)?r?this._handleBatch(t,r):this._handleBatch(t):r?this._handle(t,r):this._promiseHandle(t)}asMiddleware(){return async(t,r,n,o)=>{try{const[i,s,u]=await rt._runAllMiddleware(t,r,this._middleware);return s?(await rt._runReturnHandlers(u),o(i)):n(async l=>{try{await rt._runReturnHandlers(u)}catch(c){return l(c)}return l()})}catch(i){return o(i)}}}async _handleBatch(t,r){try{const n=await Promise.all(t.map(this._promiseHandle.bind(this)));return r?r(null,n):n}catch(n){if(r)return r(n);throw n}}_promiseHandle(t){return new Promise((r,n)=>{this._handle(t,(o,i)=>{o&&i===void 0?n(o):r(i)}).catch(n)})}async _handle(t,r){if(!t||Array.isArray(t)||typeof t!="object"){const A=new ar({code:-32603,message:"request must be plain object"});return r(A,{id:void 0,jsonrpc:"2.0",error:A})}if(typeof t.method!="string"){const A=new ar({code:-32603,message:"method must be string"});return r(A,{id:t.id,jsonrpc:"2.0",error:A})}const n=De({},t),o={id:n.id,jsonrpc:n.jsonrpc};let i=null;try{await this._processRequest(n,o)}catch(A){i=A}if(i&&(delete o.result,!o.error)){var s,u,l,c,p,y,g;typeof i=="object"&&Object.keys(i).includes("stack")===!1&&(i.stack="Stack trace is not available."),o.error=ss(i,{shouldIncludeStack:!0,fallbackError:{message:((s=i)===null||s===void 0?void 0:s.message)||((u=i)===null||u===void 0?void 0:u.toString()),code:((l=i)===null||l===void 0?void 0:l.code)||-32603,stack:((c=i)===null||c===void 0?void 0:c.stack)||"Stack trace is not available.",data:((p=i)===null||p===void 0?void 0:p.data)||((y=i)===null||y===void 0?void 0:y.message)||((g=i)===null||g===void 0?void 0:g.toString())}})}return r(i,o)}async _processRequest(t,r){const[n,o,i]=await rt._runAllMiddleware(t,r,this._middleware);if(rt._checkForCompletion(t,r,o),await rt._runReturnHandlers(i),n)throw n}}class Hd extends fn.Duplex{constructor(t){let{parent:r,name:n}=t;super({objectMode:!0}),z(this,"_parent",void 0),z(this,"_name",void 0),this._parent=r,this._name=n}_read(){}_write(t,r,n){this._parent.push({name:this._name,data:t}),n()}}const ls=Symbol("IGNORE_SUBSTREAM");class zd extends fn.Duplex{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(De(De({},t),{},{objectMode:!0})),z(this,"_substreams",void 0),z(this,"getStream",void 0),this._substreams={}}createStream(t){if(!t)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[t])throw new Error(`ObjectMultiplex - Substream for name "${t}" already exists`);const r=new Hd({parent:this,name:t});return this._substreams[t]=r,Vd(this,n=>r.destroy(n||void 0)),r}ignoreStream(t){if(!t)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[t])throw new Error(`ObjectMultiplex - Substream for name "${t}" already exists`);this._substreams[t]=ls}_read(){}_write(t,r,n){const{name:o,data:i}=t;if(!o)return window.console.warn(`ObjectMultiplex - malformed chunk without name "${t}"`),n();const s=this._substreams[o];return s?(s!==ls&&s.push(i),n()):(window.console.warn(`ObjectMultiplex - orphaned data for stream "${o}"`),n())}}function Vd(e,t){const r=vd(t);Ji(e,{readable:!1},r),Ji(e,{writable:!1},r)}var Qr={exports:{}};Qr.exports;(function(e,t){var r=200,n="__lodash_hash_undefined__",o=800,i=16,s=9007199254740991,u="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",p="[object Boolean]",y="[object Date]",g="[object Error]",A="[object Function]",R="[object GeneratorFunction]",h="[object Map]",b="[object Number]",_="[object Null]",T="[object Object]",S="[object Proxy]",F="[object RegExp]",k="[object Set]",C="[object String]",H="[object Undefined]",U="[object WeakMap]",Q="[object ArrayBuffer]",Z="[object DataView]",B="[object Float32Array]",D="[object Float64Array]",N="[object Int8Array]",X="[object Int16Array]",I="[object Int32Array]",x="[object Uint8Array]",M="[object Uint8ClampedArray]",J="[object Uint16Array]",Y="[object Uint32Array]",G=/[\\^$.*+?()[\]{}|]/g,ee=/^\[object .+?Constructor\]$/,he=/^(?:0|[1-9]\d*)$/,L={};L[B]=L[D]=L[N]=L[X]=L[I]=L[x]=L[M]=L[J]=L[Y]=!0,L[u]=L[l]=L[Q]=L[p]=L[Z]=L[y]=L[g]=L[A]=L[h]=L[b]=L[T]=L[F]=L[k]=L[C]=L[U]=!1;var oe=typeof lr=="object"&&lr&&lr.Object===Object&&lr,ge=typeof self=="object"&&self&&self.Object===Object&&self,we=oe||ge||Function("return this")(),_e=t&&!t.nodeType&&t,Ee=_e&&!0&&e&&!e.nodeType&&e,Ae=Ee&&Ee.exports===_e,Pe=Ae&&oe.process,xe=function(){try{var d=Ee&&Ee.require&&Ee.require("util").types;return d||Pe&&Pe.binding&&Pe.binding("util")}catch{}}(),be=xe&&xe.isTypedArray;function w(d,m,E){switch(E.length){case 0:return d.call(m);case 1:return d.call(m,E[0]);case 2:return d.call(m,E[0],E[1]);case 3:return d.call(m,E[0],E[1],E[2])}return d.apply(m,E)}function v(d,m){for(var E=-1,q=Array(d);++E<d;)q[E]=m(E);return q}function O(d){return function(m){return d(m)}}function $(d,m){return d==null?void 0:d[m]}function V(d,m){return function(E){return d(m(E))}}var ie=Array.prototype,ue=Function.prototype,re=Object.prototype,Ne=we["__core-js_shared__"],K=ue.toString,ve=re.hasOwnProperty,Ct=function(){var d=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),Ar=re.toString,_n=K.call(Object),Rr=RegExp("^"+K.call(ve).replace(G,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bt=Ae?we.Buffer:void 0,bt=we.Symbol,Yt=we.Uint8Array;Bt&&Bt.allocUnsafe;var mt=V(Object.getPrototypeOf,Object),Ir=Object.create,vn=re.propertyIsEnumerable,Tr=ie.splice,Ze=bt?bt.toStringTag:void 0,Mt=function(){try{var d=Tn(Object,"defineProperty");return d({},"",{}),d}catch{}}(),Sn=Bt?Bt.isBuffer:void 0,Qt=Math.max,Or=Date.now,Pr=Tn(we,"Map"),ut=Tn(Object,"create"),Xt=function(){function d(){}return function(m){if(!wt(m))return{};if(Ir)return Ir(m);d.prototype=m;var E=new d;return d.prototype=void 0,E}}();function Ye(d){var m=-1,E=d==null?0:d.length;for(this.clear();++m<E;){var q=d[m];this.set(q[0],q[1])}}function En(){this.__data__=ut?ut(null):{},this.size=0}function er(d){var m=this.has(d)&&delete this.__data__[d];return this.size-=m?1:0,m}function xr(d){var m=this.__data__;if(ut){var E=m[d];return E===n?void 0:E}return ve.call(m,d)?m[d]:void 0}function a(d){var m=this.__data__;return ut?m[d]!==void 0:ve.call(m,d)}function f(d,m){var E=this.__data__;return this.size+=this.has(d)?0:1,E[d]=ut&&m===void 0?n:m,this}Ye.prototype.clear=En,Ye.prototype.delete=er,Ye.prototype.get=xr,Ye.prototype.has=a,Ye.prototype.set=f;function P(d){var m=-1,E=d==null?0:d.length;for(this.clear();++m<E;){var q=d[m];this.set(q[0],q[1])}}function j(){this.__data__=[],this.size=0}function W(d){var m=this.__data__,E=Lr(m,d);if(E<0)return!1;var q=m.length-1;return E==q?m.pop():Tr.call(m,E,1),--this.size,!0}function me(d){var m=this.__data__,E=Lr(m,d);return E<0?void 0:m[E][1]}function Te(d){return Lr(this.__data__,d)>-1}function Qe(d,m){var E=this.__data__,q=Lr(E,d);return q<0?(++this.size,E.push([d,m])):E[q][1]=m,this}P.prototype.clear=j,P.prototype.delete=W,P.prototype.get=me,P.prototype.has=Te,P.prototype.set=Qe;function Xe(d){var m=-1,E=d==null?0:d.length;for(this.clear();++m<E;){var q=d[m];this.set(q[0],q[1])}}function An(){this.size=0,this.__data__={hash:new Ye,map:new(Pr||P),string:new Ye}}function Nr(d){var m=Cr(this,d).delete(d);return this.size-=m?1:0,m}function kr(d){return Cr(this,d).get(d)}function tr(d){return Cr(this,d).has(d)}function rr(d,m){var E=Cr(this,d),q=E.size;return E.set(d,m),this.size+=E.size==q?0:1,this}Xe.prototype.clear=An,Xe.prototype.delete=Nr,Xe.prototype.get=kr,Xe.prototype.has=tr,Xe.prototype.set=rr;function He(d){var m=this.__data__=new P(d);this.size=m.size}function yt(){this.__data__=new P,this.size=0}function et(d){var m=this.__data__,E=m.delete(d);return this.size=m.size,E}function Fe(d){return this.__data__.get(d)}function Fa(d){return this.__data__.has(d)}function $a(d,m){var E=this.__data__;if(E instanceof P){var q=E.__data__;if(!Pr||q.length<r-1)return q.push([d,m]),this.size=++E.size,this;E=this.__data__=new Xe(q)}return E.set(d,m),this.size=E.size,this}He.prototype.clear=yt,He.prototype.delete=et,He.prototype.get=Fe,He.prototype.has=Fa,He.prototype.set=$a;function qa(d,m){var E=xn(d),q=!E&&Pn(d),te=!E&&!q&&ei(d),ae=!E&&!q&&!te&&ri(d),ce=E||q||te||ae,ne=ce?v(d.length,String):[],de=ne.length;for(var $e in d)ce&&($e=="length"||te&&($e=="offset"||$e=="parent")||ae&&($e=="buffer"||$e=="byteLength"||$e=="byteOffset")||Qo($e,de))||ne.push($e);return ne}function Rn(d,m,E){(E!==void 0&&!Br(d[m],E)||E===void 0&&!(m in d))&&In(d,m,E)}function Ha(d,m,E){var q=d[m];(!(ve.call(d,m)&&Br(q,E))||E===void 0&&!(m in d))&&In(d,m,E)}function Lr(d,m){for(var E=d.length;E--;)if(Br(d[E][0],m))return E;return-1}function In(d,m,E){m=="__proto__"&&Mt?Mt(d,m,{configurable:!0,enumerable:!0,value:E,writable:!0}):d[m]=E}var za=ol();function jr(d){return d==null?d===void 0?H:_:Ze&&Ze in Object(d)?il(d):dl(d)}function Zo(d){return nr(d)&&jr(d)==u}function Va(d){if(!wt(d)||ul(d))return!1;var m=kn(d)?Rr:ee;return m.test(gl(d))}function Ga(d){return nr(d)&&ti(d.length)&&!!L[jr(d)]}function Ka(d){if(!wt(d))return cl(d);var m=Xo(d),E=[];for(var q in d)q=="constructor"&&(m||!ve.call(d,q))||E.push(q);return E}function Yo(d,m,E,q,te){d!==m&&za(m,function(ae,ce){if(te||(te=new He),wt(ae))Ja(d,m,ce,E,Yo,q,te);else{var ne=q?q(On(d,ce),ae,ce+"",d,m,te):void 0;ne===void 0&&(ne=ae),Rn(d,ce,ne)}},ni)}function Ja(d,m,E,q,te,ae,ce){var ne=On(d,E),de=On(m,E),$e=ce.get(de);if($e){Rn(d,E,$e);return}var ke=ae?ae(ne,de,E+"",d,m,ce):void 0,or=ke===void 0;if(or){var Ln=xn(de),jn=!Ln&&ei(de),ii=!Ln&&!jn&&ri(de);ke=de,Ln||jn||ii?xn(ne)?ke=ne:bl(ne)?ke=tl(ne):jn?(or=!1,ke=Qa(de)):ii?(or=!1,ke=el(de)):ke=[]:ml(de)||Pn(de)?(ke=ne,Pn(ne)?ke=yl(ne):(!wt(ne)||kn(ne))&&(ke=sl(de))):or=!1}or&&(ce.set(de,ke),te(ke,de,q,ae,ce),ce.delete(de)),Rn(d,E,ke)}function Za(d,m){return hl(fl(d,m,oi),d+"")}var Ya=Mt?function(d,m){return Mt(d,"toString",{configurable:!0,enumerable:!1,value:_l(m),writable:!0})}:oi;function Qa(d,m){return d.slice()}function Xa(d){var m=new d.constructor(d.byteLength);return new Yt(m).set(new Yt(d)),m}function el(d,m){var E=Xa(d.buffer);return new d.constructor(E,d.byteOffset,d.length)}function tl(d,m){var E=-1,q=d.length;for(m||(m=Array(q));++E<q;)m[E]=d[E];return m}function rl(d,m,E,q){var te=!E;E||(E={});for(var ae=-1,ce=m.length;++ae<ce;){var ne=m[ae],de=void 0;de===void 0&&(de=d[ne]),te?In(E,ne,de):Ha(E,ne,de)}return E}function nl(d){return Za(function(m,E){var q=-1,te=E.length,ae=te>1?E[te-1]:void 0,ce=te>2?E[2]:void 0;for(ae=d.length>3&&typeof ae=="function"?(te--,ae):void 0,ce&&al(E[0],E[1],ce)&&(ae=te<3?void 0:ae,te=1),m=Object(m);++q<te;){var ne=E[q];ne&&d(m,ne,q,ae)}return m})}function ol(d){return function(m,E,q){for(var te=-1,ae=Object(m),ce=q(m),ne=ce.length;ne--;){var de=ce[++te];if(E(ae[de],de,ae)===!1)break}return m}}function Cr(d,m){var E=d.__data__;return ll(m)?E[typeof m=="string"?"string":"hash"]:E.map}function Tn(d,m){var E=$(d,m);return Va(E)?E:void 0}function il(d){var m=ve.call(d,Ze),E=d[Ze];try{d[Ze]=void 0;var q=!0}catch{}var te=Ar.call(d);return q&&(m?d[Ze]=E:delete d[Ze]),te}function sl(d){return typeof d.constructor=="function"&&!Xo(d)?Xt(mt(d)):{}}function Qo(d,m){var E=typeof d;return m=m??s,!!m&&(E=="number"||E!="symbol"&&he.test(d))&&d>-1&&d%1==0&&d<m}function al(d,m,E){if(!wt(E))return!1;var q=typeof m;return(q=="number"?Nn(E)&&Qo(m,E.length):q=="string"&&m in E)?Br(E[m],d):!1}function ll(d){var m=typeof d;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?d!=="__proto__":d===null}function ul(d){return!!Ct&&Ct in d}function Xo(d){var m=d&&d.constructor,E=typeof m=="function"&&m.prototype||re;return d===E}function cl(d){var m=[];if(d!=null)for(var E in Object(d))m.push(E);return m}function dl(d){return Ar.call(d)}function fl(d,m,E){return m=Qt(m===void 0?d.length-1:m,0),function(){for(var q=arguments,te=-1,ae=Qt(q.length-m,0),ce=Array(ae);++te<ae;)ce[te]=q[m+te];te=-1;for(var ne=Array(m+1);++te<m;)ne[te]=q[te];return ne[m]=E(ce),w(d,this,ne)}}function On(d,m){if(!(m==="constructor"&&typeof d[m]=="function")&&m!="__proto__")return d[m]}var hl=pl(Ya);function pl(d){var m=0,E=0;return function(){var q=Or(),te=i-(q-E);if(E=q,te>0){if(++m>=o)return arguments[0]}else m=0;return d.apply(void 0,arguments)}}function gl(d){if(d!=null){try{return K.call(d)}catch{}try{return d+""}catch{}}return""}function Br(d,m){return d===m||d!==d&&m!==m}var Pn=Zo(function(){return arguments}())?Zo:function(d){return nr(d)&&ve.call(d,"callee")&&!vn.call(d,"callee")},xn=Array.isArray;function Nn(d){return d!=null&&ti(d.length)&&!kn(d)}function bl(d){return nr(d)&&Nn(d)}var ei=Sn||vl;function kn(d){if(!wt(d))return!1;var m=jr(d);return m==A||m==R||m==c||m==S}function ti(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=s}function wt(d){var m=typeof d;return d!=null&&(m=="object"||m=="function")}function nr(d){return d!=null&&typeof d=="object"}function ml(d){if(!nr(d)||jr(d)!=T)return!1;var m=mt(d);if(m===null)return!0;var E=ve.call(m,"constructor")&&m.constructor;return typeof E=="function"&&E instanceof E&&K.call(E)==_n}var ri=be?O(be):Ga;function yl(d){return rl(d,ni(d))}function ni(d){return Nn(d)?qa(d):Ka(d)}var wl=nl(function(d,m,E){Yo(d,m,E)});function _l(d){return function(){return d}}function oi(d){return d}function vl(){return!1}e.exports=wl})(Qr,Qr.exports);Qr.exports;var Sa={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.log=r()})(lr,function(){var t=function(){},r="undefined",n=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],i={},s=null;function u(h,b){var _=h[b];if(typeof _.bind=="function")return _.bind(h);try{return Function.prototype.bind.call(_,h)}catch{return function(){return Function.prototype.apply.apply(_,[h,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(h){return h==="debug"&&(h="log"),typeof console===r?!1:h==="trace"&&n?l:console[h]!==void 0?u(console,h):console.log!==void 0?u(console,"log"):t}function p(){for(var h=this.getLevel(),b=0;b<o.length;b++){var _=o[b];this[_]=b<h?t:this.methodFactory(_,h,this.name)}if(this.log=this.debug,typeof console===r&&h<this.levels.SILENT)return"No console available for logging"}function y(h){return function(){typeof console!==r&&(p.call(this),this[h].apply(this,arguments))}}function g(h,b,_){return c(h)||y.apply(this,arguments)}function A(h,b){var _=this,T,S,F,k="loglevel";typeof h=="string"?k+=":"+h:typeof h=="symbol"&&(k=void 0);function C(B){var D=(o[B]||"silent").toUpperCase();if(!(typeof window===r||!k)){try{window.localStorage[k]=D;return}catch{}try{window.document.cookie=encodeURIComponent(k)+"="+D+";"}catch{}}}function H(){var B;if(!(typeof window===r||!k)){try{B=window.localStorage[k]}catch{}if(typeof B===r)try{var D=window.document.cookie,N=encodeURIComponent(k),X=D.indexOf(N+"=");X!==-1&&(B=/^([^;]+)/.exec(D.slice(X+N.length+1))[1])}catch{}return _.levels[B]===void 0&&(B=void 0),B}}function U(){if(!(typeof window===r||!k)){try{window.localStorage.removeItem(k)}catch{}try{window.document.cookie=encodeURIComponent(k)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function Q(B){var D=B;if(typeof D=="string"&&_.levels[D.toUpperCase()]!==void 0&&(D=_.levels[D.toUpperCase()]),typeof D=="number"&&D>=0&&D<=_.levels.SILENT)return D;throw new TypeError("log.setLevel() called with invalid level: "+B)}_.name=h,_.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},_.methodFactory=b||g,_.getLevel=function(){return F??S??T},_.setLevel=function(B,D){return F=Q(B),D!==!1&&C(F),p.call(_)},_.setDefaultLevel=function(B){S=Q(B),H()||_.setLevel(B,!1)},_.resetLevel=function(){F=null,U(),p.call(_)},_.enableAll=function(B){_.setLevel(_.levels.TRACE,B)},_.disableAll=function(B){_.setLevel(_.levels.SILENT,B)},_.rebuild=function(){if(s!==_&&(T=Q(s.getLevel())),p.call(_),s===_)for(var B in i)i[B].rebuild()},T=Q(s?s.getLevel():"WARN");var Z=H();Z!=null&&(F=Q(Z)),p.call(_)}s=new A,s.getLogger=function(h){if(typeof h!="symbol"&&typeof h!="string"||h==="")throw new TypeError("You must supply a name when creating a logger.");var b=i[h];return b||(b=i[h]=new A(h,s.methodFactory)),b};var R=typeof window!==r?window.log:void 0;return s.noConflict=function(){return typeof window!==r&&window.log===s&&(window.log=R),s},s.getLoggers=function(){return i},s.default=s,s})})(Sa);var Ea=Sa.exports;const Xr=Kt(Ea),Gd=Xr.getLogger("http-helpers");Gd.setLevel(Ea.levels.INFO);function us(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function Kd(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function gn(e,...t){if(!Kd(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function Jd(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");us(e.outputLen),us(e.blockLen)}function en(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Zd(e,t){gn(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const eo=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const to=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ze=(e,t)=>e<<32-t|e>>>t;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Yd(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Wo(e){return typeof e=="string"&&(e=Yd(e)),gn(e),e}function Qd(...e){let t=0;for(let n=0;n<e.length;n++){const o=e[n];gn(o),t+=o.length}const r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){const i=e[n];r.set(i,o),o+=i.length}return r}class Aa{clone(){return this._cloneInto()}}function Xd(e){const t=n=>e().update(Wo(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function ef(e=32){if(eo&&typeof eo.getRandomValues=="function")return eo.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function tf(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const o=BigInt(32),i=BigInt(4294967295),s=Number(r>>o&i),u=Number(r&i),l=n?4:0,c=n?0:4;e.setUint32(t+l,s,n),e.setUint32(t+c,u,n)}const rf=(e,t,r)=>e&t^~e&r,nf=(e,t,r)=>e&t^e&r^t&r;class of extends Aa{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=to(this.buffer)}update(t){en(this);const{view:r,buffer:n,blockLen:o}=this;t=Wo(t);const i=t.length;for(let s=0;s<i;){const u=Math.min(o-this.pos,i-s);if(u===o){const l=to(t);for(;o<=i-s;s+=o)this.process(l,s);continue}n.set(t.subarray(s,s+u),this.pos),this.pos+=u,s+=u,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){en(this),Zd(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:i}=this;let{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(n,0),s=0);for(let y=s;y<o;y++)r[y]=0;tf(n,o-8,BigInt(this.length*8),i),this.process(n,0);const u=to(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=l/4,p=this.get();if(c>p.length)throw new Error("_sha2: outputLen bigger than state");for(let y=0;y<c;y++)u.setUint32(4*y,p[y],i)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:i,destroyed:s,pos:u}=this;return t.length=o,t.pos=u,t.finished=i,t.destroyed=s,o%r&&t.buffer.set(n),t}}const sf=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ct=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),dt=new Uint32Array(64);class af extends of{constructor(){super(64,32,8,!1),this.A=ct[0]|0,this.B=ct[1]|0,this.C=ct[2]|0,this.D=ct[3]|0,this.E=ct[4]|0,this.F=ct[5]|0,this.G=ct[6]|0,this.H=ct[7]|0}get(){const{A:t,B:r,C:n,D:o,E:i,F:s,G:u,H:l}=this;return[t,r,n,o,i,s,u,l]}set(t,r,n,o,i,s,u,l){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=u|0,this.H=l|0}process(t,r){for(let y=0;y<16;y++,r+=4)dt[y]=t.getUint32(r,!1);for(let y=16;y<64;y++){const g=dt[y-15],A=dt[y-2],R=ze(g,7)^ze(g,18)^g>>>3,h=ze(A,17)^ze(A,19)^A>>>10;dt[y]=h+dt[y-7]+R+dt[y-16]|0}let{A:n,B:o,C:i,D:s,E:u,F:l,G:c,H:p}=this;for(let y=0;y<64;y++){const g=ze(u,6)^ze(u,11)^ze(u,25),A=p+g+rf(u,l,c)+sf[y]+dt[y]|0,R=(ze(n,2)^ze(n,13)^ze(n,22))+nf(n,o,i)|0;p=c,c=l,l=u,u=s+A|0,s=i,i=o,o=n,n=A+R|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,u=u+this.E|0,l=l+this.F|0,c=c+this.G|0,p=p+this.H|0,this.set(n,o,i,s,u,l,c,p)}roundClean(){dt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const lf=Xd(()=>new af);class Ra extends Aa{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,Jd(t);const n=Wo(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,i=new Uint8Array(o);i.set(n.length>o?t.create().update(n).digest():n);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=t.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(t){return en(this),this.iHash.update(t),this}digestInto(t){en(this),gn(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:o,destroyed:i,blockLen:s,outputLen:u}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=s,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Ia=(e,t,r)=>new Ra(e,t).update(r).digest();Ia.create=(e,t)=>new Ra(e,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ta=BigInt(0),bn=BigInt(1),uf=BigInt(2);function Ot(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function vr(e){if(!Ot(e))throw new Error("Uint8Array expected")}const cf=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function zt(e){vr(e);let t="";for(let r=0;r<e.length;r++)t+=cf[e[r]];return t}function Oa(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function Fo(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}const tt={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function cs(e){if(e>=tt._0&&e<=tt._9)return e-tt._0;if(e>=tt._A&&e<=tt._F)return e-(tt._A-10);if(e>=tt._a&&e<=tt._f)return e-(tt._a-10)}function Vt(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let o=0,i=0;o<r;o++,i+=2){const s=cs(e.charCodeAt(i)),u=cs(e.charCodeAt(i+1));if(s===void 0||u===void 0){const l=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+i)}n[o]=s*16+u}return n}function It(e){return Fo(zt(e))}function $o(e){return vr(e),Fo(zt(Uint8Array.from(e).reverse()))}function Gt(e,t){return Vt(e.toString(16).padStart(t*2,"0"))}function qo(e,t){return Gt(e,t).reverse()}function df(e){return Vt(Oa(e))}function qe(e,t,r){let n;if(typeof t=="string")try{n=Vt(t)}catch(i){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${i}`)}else if(Ot(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);const o=n.length;if(typeof r=="number"&&o!==r)throw new Error(`${e} expected ${r} bytes, got ${o}`);return n}function mr(...e){let t=0;for(let n=0;n<e.length;n++){const o=e[n];vr(o),t+=o.length}const r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){const i=e[n];r.set(i,o),o+=i.length}return r}function ff(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}function hf(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function pf(e){let t;for(t=0;e>Ta;e>>=bn,t+=1);return t}function gf(e,t){return e>>BigInt(t)&bn}function bf(e,t,r){return e|(r?bn:Ta)<<BigInt(t)}const Ho=e=>(uf<<BigInt(e-1))-bn,ro=e=>new Uint8Array(e),ds=e=>Uint8Array.from(e);function Pa(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=ro(e),o=ro(e),i=0;const s=()=>{n.fill(1),o.fill(0),i=0},u=(...p)=>r(o,n,...p),l=(p=ro())=>{o=u(ds([0]),p),n=u(),p.length!==0&&(o=u(ds([1]),p),n=u())},c=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let p=0;const y=[];for(;p<t;){n=u();const g=n.slice();y.push(g),p+=n.length}return mr(...y)};return(p,y)=>{s(),l(p);let g;for(;!(g=y(c()));)l();return s(),g}}const mf={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||Ot(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Sr(e,t,r={}){const n=(o,i,s)=>{const u=mf[i];if(typeof u!="function")throw new Error(`Invalid validator "${i}", expected function`);const l=e[o];if(!(s&&l===void 0)&&!u(l,e))throw new Error(`Invalid param ${String(o)}=${l} (${typeof l}), expected ${i}`)};for(const[o,i]of Object.entries(t))n(o,i,!1);for(const[o,i]of Object.entries(r))n(o,i,!0);return e}const yf=Object.freeze(Object.defineProperty({__proto__:null,abytes:vr,bitGet:gf,bitLen:pf,bitMask:Ho,bitSet:bf,bytesToHex:zt,bytesToNumberBE:It,bytesToNumberLE:$o,concatBytes:mr,createHmacDrbg:Pa,ensureBytes:qe,equalBytes:ff,hexToBytes:Vt,hexToNumber:Fo,isBytes:Ot,numberToBytesBE:Gt,numberToBytesLE:qo,numberToHexUnpadded:Oa,numberToVarBytesBE:df,utf8ToBytes:hf,validateObject:Sr},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ye=BigInt(0),pe=BigInt(1),St=BigInt(2),wf=BigInt(3),wo=BigInt(4),fs=BigInt(5),hs=BigInt(8);BigInt(9);BigInt(16);function Oe(e,t){const r=e%t;return r>=ye?r:t+r}function _f(e,t,r){if(r<=ye||t<ye)throw new Error("Expected power/modulo > 0");if(r===pe)return ye;let n=pe;for(;t>ye;)t&pe&&(n=n*e%r),e=e*e%r,t>>=pe;return n}function Be(e,t,r){let n=e;for(;t-- >ye;)n*=n,n%=r;return n}function _o(e,t){if(e===ye||t<=ye)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=Oe(e,t),n=t,o=ye,i=pe;for(;r!==ye;){const s=n/r,u=n%r,l=o-i*s;n=r,r=u,o=i,i=l}if(n!==pe)throw new Error("invert: does not exist");return Oe(o,t)}function vf(e){const t=(e-pe)/St;let r,n,o;for(r=e-pe,n=0;r%St===ye;r/=St,n++);for(o=St;o<e&&_f(o,t,e)!==e-pe;o++);if(n===1){const s=(e+pe)/wo;return function(u,l){const c=u.pow(l,s);if(!u.eql(u.sqr(c),l))throw new Error("Cannot find square root");return c}}const i=(r+pe)/St;return function(s,u){if(s.pow(u,t)===s.neg(s.ONE))throw new Error("Cannot find square root");let l=n,c=s.pow(s.mul(s.ONE,o),r),p=s.pow(u,i),y=s.pow(u,r);for(;!s.eql(y,s.ONE);){if(s.eql(y,s.ZERO))return s.ZERO;let g=1;for(let R=s.sqr(y);g<l&&!s.eql(R,s.ONE);g++)R=s.sqr(R);const A=s.pow(c,pe<<BigInt(l-g-1));c=s.sqr(A),p=s.mul(p,A),y=s.mul(y,c),l=g}return p}}function Sf(e){if(e%wo===wf){const t=(e+pe)/wo;return function(r,n){const o=r.pow(n,t);if(!r.eql(r.sqr(o),n))throw new Error("Cannot find square root");return o}}if(e%hs===fs){const t=(e-fs)/hs;return function(r,n){const o=r.mul(n,St),i=r.pow(o,t),s=r.mul(n,i),u=r.mul(r.mul(s,St),i),l=r.mul(s,r.sub(u,r.ONE));if(!r.eql(r.sqr(l),n))throw new Error("Cannot find square root");return l}}return vf(e)}const Ef=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Af(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Ef.reduce((n,o)=>(n[o]="function",n),t);return Sr(e,r)}function Rf(e,t,r){if(r<ye)throw new Error("Expected power > 0");if(r===ye)return e.ONE;if(r===pe)return t;let n=e.ONE,o=t;for(;r>ye;)r&pe&&(n=e.mul(n,o)),o=e.sqr(o),r>>=pe;return n}function If(e,t){const r=new Array(t.length),n=t.reduce((i,s,u)=>e.is0(s)?i:(r[u]=i,e.mul(i,s)),e.ONE),o=e.inv(n);return t.reduceRight((i,s,u)=>e.is0(s)?i:(r[u]=e.mul(i,r[u]),e.mul(i,s)),o),r}function xa(e,t){const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Tf(e,t,r=!1,n={}){if(e<=ye)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:i}=xa(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=Sf(e),u=Object.freeze({ORDER:e,BITS:o,BYTES:i,MASK:Ho(o),ZERO:ye,ONE:pe,create:l=>Oe(l,e),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return ye<=l&&l<e},is0:l=>l===ye,isOdd:l=>(l&pe)===pe,neg:l=>Oe(-l,e),eql:(l,c)=>l===c,sqr:l=>Oe(l*l,e),add:(l,c)=>Oe(l+c,e),sub:(l,c)=>Oe(l-c,e),mul:(l,c)=>Oe(l*c,e),pow:(l,c)=>Rf(u,l,c),div:(l,c)=>Oe(l*_o(c,e),e),sqrN:l=>l*l,addN:(l,c)=>l+c,subN:(l,c)=>l-c,mulN:(l,c)=>l*c,inv:l=>_o(l,e),sqrt:n.sqrt||(l=>s(u,l)),invertBatch:l=>If(u,l),cmov:(l,c,p)=>p?c:l,toBytes:l=>r?qo(l,i):Gt(l,i),fromBytes:l=>{if(l.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${l.length}`);return r?$o(l):It(l)}});return Object.freeze(u)}function Na(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function ka(e){const t=Na(e);return t+Math.ceil(t/2)}function Of(e,t,r=!1){const n=e.length,o=Na(t),i=ka(t);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const s=r?It(e):$o(e),u=Oe(s,t-pe)+pe;return r?qo(u,o):Gt(u,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Pf=BigInt(0),no=BigInt(1);function xf(e,t){const r=(o,i)=>{const s=i.negate();return o?s:i},n=o=>{const i=Math.ceil(t/o)+1,s=2**(o-1);return{windows:i,windowSize:s}};return{constTimeNegate:r,unsafeLadder(o,i){let s=e.ZERO,u=o;for(;i>Pf;)i&no&&(s=s.add(u)),u=u.double(),i>>=no;return s},precomputeWindow(o,i){const{windows:s,windowSize:u}=n(i),l=[];let c=o,p=c;for(let y=0;y<s;y++){p=c,l.push(p);for(let g=1;g<u;g++)p=p.add(c),l.push(p);c=p.double()}return l},wNAF(o,i,s){const{windows:u,windowSize:l}=n(o);let c=e.ZERO,p=e.BASE;const y=BigInt(2**o-1),g=2**o,A=BigInt(o);for(let R=0;R<u;R++){const h=R*l;let b=Number(s&y);s>>=A,b>l&&(b-=g,s+=no);const _=h,T=h+Math.abs(b)-1,S=R%2!==0,F=b<0;b===0?p=p.add(r(S,i[_])):c=c.add(r(F,i[T]))}return{p:c,f:p}},wNAFCached(o,i,s,u){const l=o._WINDOW_SIZE||1;let c=i.get(o);return c||(c=this.precomputeWindow(o,l),l!==1&&i.set(o,u(c))),this.wNAF(l,c,s)}}}function La(e){return Af(e.Fp),Sr(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...xa(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Nf(e){const t=La(e);Sr(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:o}=t;if(r){if(!n.eql(o,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:kf,hexToBytes:Lf}=yf,At={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){const{Err:t}=At;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");const r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:kf(n),l:e.subarray(r+2)}},toSig(e){const{Err:t}=At,r=typeof e=="string"?Lf(e):e;vr(r);let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");const{d:o,l:i}=At._parseInt(r.subarray(2)),{d:s,l:u}=At._parseInt(i);if(u.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s}},hexFromSig(e){const t=c=>Number.parseInt(c[0],16)&8?"00"+c:c,r=c=>{const p=c.toString(16);return p.length&1?`0${p}`:p},n=t(r(e.s)),o=t(r(e.r)),i=n.length/2,s=o.length/2,u=r(i),l=r(s);return`30${r(s+i+4)}02${l}${o}02${u}${n}`}},nt=BigInt(0),Me=BigInt(1);BigInt(2);const ps=BigInt(3);BigInt(4);function jf(e){const t=Nf(e),{Fp:r}=t,n=t.toBytes||((R,h,b)=>{const _=h.toAffine();return mr(Uint8Array.from([4]),r.toBytes(_.x),r.toBytes(_.y))}),o=t.fromBytes||(R=>{const h=R.subarray(1),b=r.fromBytes(h.subarray(0,r.BYTES)),_=r.fromBytes(h.subarray(r.BYTES,2*r.BYTES));return{x:b,y:_}});function i(R){const{a:h,b}=t,_=r.sqr(R),T=r.mul(_,R);return r.add(r.add(T,r.mul(R,h)),b)}if(!r.eql(r.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function s(R){return typeof R=="bigint"&&nt<R&&R<t.n}function u(R){if(!s(R))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(R){const{allowedPrivateKeyLengths:h,nByteLength:b,wrapPrivateKey:_,n:T}=t;if(h&&typeof R!="bigint"){if(Ot(R)&&(R=zt(R)),typeof R!="string"||!h.includes(R.length))throw new Error("Invalid key");R=R.padStart(b*2,"0")}let S;try{S=typeof R=="bigint"?R:It(qe("private key",R,b))}catch{throw new Error(`private key must be ${b} bytes, hex or bigint, not ${typeof R}`)}return _&&(S=Oe(S,T)),u(S),S}const c=new Map;function p(R){if(!(R instanceof y))throw new Error("ProjectivePoint expected")}class y{constructor(h,b,_){if(this.px=h,this.py=b,this.pz=_,h==null||!r.isValid(h))throw new Error("x required");if(b==null||!r.isValid(b))throw new Error("y required");if(_==null||!r.isValid(_))throw new Error("z required")}static fromAffine(h){const{x:b,y:_}=h||{};if(!h||!r.isValid(b)||!r.isValid(_))throw new Error("invalid affine point");if(h instanceof y)throw new Error("projective point not allowed");const T=S=>r.eql(S,r.ZERO);return T(b)&&T(_)?y.ZERO:new y(b,_,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){const b=r.invertBatch(h.map(_=>_.pz));return h.map((_,T)=>_.toAffine(b[T])).map(y.fromAffine)}static fromHex(h){const b=y.fromAffine(o(qe("pointHex",h)));return b.assertValidity(),b}static fromPrivateKey(h){return y.BASE.multiply(l(h))}_setWindowSize(h){this._WINDOW_SIZE=h,c.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:h,y:b}=this.toAffine();if(!r.isValid(h)||!r.isValid(b))throw new Error("bad point: x or y not FE");const _=r.sqr(b),T=i(h);if(!r.eql(_,T))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:h}=this.toAffine();if(r.isOdd)return!r.isOdd(h);throw new Error("Field doesn't support isOdd")}equals(h){p(h);const{px:b,py:_,pz:T}=this,{px:S,py:F,pz:k}=h,C=r.eql(r.mul(b,k),r.mul(S,T)),H=r.eql(r.mul(_,k),r.mul(F,T));return C&&H}negate(){return new y(this.px,r.neg(this.py),this.pz)}double(){const{a:h,b}=t,_=r.mul(b,ps),{px:T,py:S,pz:F}=this;let k=r.ZERO,C=r.ZERO,H=r.ZERO,U=r.mul(T,T),Q=r.mul(S,S),Z=r.mul(F,F),B=r.mul(T,S);return B=r.add(B,B),H=r.mul(T,F),H=r.add(H,H),k=r.mul(h,H),C=r.mul(_,Z),C=r.add(k,C),k=r.sub(Q,C),C=r.add(Q,C),C=r.mul(k,C),k=r.mul(B,k),H=r.mul(_,H),Z=r.mul(h,Z),B=r.sub(U,Z),B=r.mul(h,B),B=r.add(B,H),H=r.add(U,U),U=r.add(H,U),U=r.add(U,Z),U=r.mul(U,B),C=r.add(C,U),Z=r.mul(S,F),Z=r.add(Z,Z),U=r.mul(Z,B),k=r.sub(k,U),H=r.mul(Z,Q),H=r.add(H,H),H=r.add(H,H),new y(k,C,H)}add(h){p(h);const{px:b,py:_,pz:T}=this,{px:S,py:F,pz:k}=h;let C=r.ZERO,H=r.ZERO,U=r.ZERO;const Q=t.a,Z=r.mul(t.b,ps);let B=r.mul(b,S),D=r.mul(_,F),N=r.mul(T,k),X=r.add(b,_),I=r.add(S,F);X=r.mul(X,I),I=r.add(B,D),X=r.sub(X,I),I=r.add(b,T);let x=r.add(S,k);return I=r.mul(I,x),x=r.add(B,N),I=r.sub(I,x),x=r.add(_,T),C=r.add(F,k),x=r.mul(x,C),C=r.add(D,N),x=r.sub(x,C),U=r.mul(Q,I),C=r.mul(Z,N),U=r.add(C,U),C=r.sub(D,U),U=r.add(D,U),H=r.mul(C,U),D=r.add(B,B),D=r.add(D,B),N=r.mul(Q,N),I=r.mul(Z,I),D=r.add(D,N),N=r.sub(B,N),N=r.mul(Q,N),I=r.add(I,N),B=r.mul(D,I),H=r.add(H,B),B=r.mul(x,I),C=r.mul(X,C),C=r.sub(C,B),B=r.mul(X,D),U=r.mul(x,U),U=r.add(U,B),new y(C,H,U)}subtract(h){return this.add(h.negate())}is0(){return this.equals(y.ZERO)}wNAF(h){return A.wNAFCached(this,c,h,b=>{const _=r.invertBatch(b.map(T=>T.pz));return b.map((T,S)=>T.toAffine(_[S])).map(y.fromAffine)})}multiplyUnsafe(h){const b=y.ZERO;if(h===nt)return b;if(u(h),h===Me)return this;const{endo:_}=t;if(!_)return A.unsafeLadder(this,h);let{k1neg:T,k1:S,k2neg:F,k2:k}=_.splitScalar(h),C=b,H=b,U=this;for(;S>nt||k>nt;)S&Me&&(C=C.add(U)),k&Me&&(H=H.add(U)),U=U.double(),S>>=Me,k>>=Me;return T&&(C=C.negate()),F&&(H=H.negate()),H=new y(r.mul(H.px,_.beta),H.py,H.pz),C.add(H)}multiply(h){u(h);let b=h,_,T;const{endo:S}=t;if(S){const{k1neg:F,k1:k,k2neg:C,k2:H}=S.splitScalar(b);let{p:U,f:Q}=this.wNAF(k),{p:Z,f:B}=this.wNAF(H);U=A.constTimeNegate(F,U),Z=A.constTimeNegate(C,Z),Z=new y(r.mul(Z.px,S.beta),Z.py,Z.pz),_=U.add(Z),T=Q.add(B)}else{const{p:F,f:k}=this.wNAF(b);_=F,T=k}return y.normalizeZ([_,T])[0]}multiplyAndAddUnsafe(h,b,_){const T=y.BASE,S=(k,C)=>C===nt||C===Me||!k.equals(T)?k.multiplyUnsafe(C):k.multiply(C),F=S(this,b).add(S(h,_));return F.is0()?void 0:F}toAffine(h){const{px:b,py:_,pz:T}=this,S=this.is0();h==null&&(h=S?r.ONE:r.inv(T));const F=r.mul(b,h),k=r.mul(_,h),C=r.mul(T,h);if(S)return{x:r.ZERO,y:r.ZERO};if(!r.eql(C,r.ONE))throw new Error("invZ was invalid");return{x:F,y:k}}isTorsionFree(){const{h,isTorsionFree:b}=t;if(h===Me)return!0;if(b)return b(y,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h,clearCofactor:b}=t;return h===Me?this:b?b(y,this):this.multiplyUnsafe(t.h)}toRawBytes(h=!0){return this.assertValidity(),n(y,this,h)}toHex(h=!0){return zt(this.toRawBytes(h))}}y.BASE=new y(t.Gx,t.Gy,r.ONE),y.ZERO=new y(r.ZERO,r.ONE,r.ZERO);const g=t.nBitLength,A=xf(y,t.endo?Math.ceil(g/2):g);return{CURVE:t,ProjectivePoint:y,normPrivateKeyToScalar:l,weierstrassEquation:i,isWithinCurveOrder:s}}function Cf(e){const t=La(e);return Sr(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Bf(e){const t=Cf(e),{Fp:r,n}=t,o=r.BYTES+1,i=2*r.BYTES+1;function s(I){return nt<I&&I<r.ORDER}function u(I){return Oe(I,n)}function l(I){return _o(I,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:p,weierstrassEquation:y,isWithinCurveOrder:g}=jf({...t,toBytes(I,x,M){const J=x.toAffine(),Y=r.toBytes(J.x),G=mr;return M?G(Uint8Array.from([x.hasEvenY()?2:3]),Y):G(Uint8Array.from([4]),Y,r.toBytes(J.y))},fromBytes(I){const x=I.length,M=I[0],J=I.subarray(1);if(x===o&&(M===2||M===3)){const Y=It(J);if(!s(Y))throw new Error("Point is not on curve");const G=y(Y);let ee;try{ee=r.sqrt(G)}catch(L){const oe=L instanceof Error?": "+L.message:"";throw new Error("Point is not on curve"+oe)}const he=(ee&Me)===Me;return(M&1)===1!==he&&(ee=r.neg(ee)),{x:Y,y:ee}}else if(x===i&&M===4){const Y=r.fromBytes(J.subarray(0,r.BYTES)),G=r.fromBytes(J.subarray(r.BYTES,2*r.BYTES));return{x:Y,y:G}}else throw new Error(`Point of length ${x} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}}),A=I=>zt(Gt(I,t.nByteLength));function R(I){const x=n>>Me;return I>x}function h(I){return R(I)?u(-I):I}const b=(I,x,M)=>It(I.slice(x,M));class _{constructor(x,M,J){this.r=x,this.s=M,this.recovery=J,this.assertValidity()}static fromCompact(x){const M=t.nByteLength;return x=qe("compactSignature",x,M*2),new _(b(x,0,M),b(x,M,2*M))}static fromDER(x){const{r:M,s:J}=At.toSig(qe("DER",x));return new _(M,J)}assertValidity(){if(!g(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!g(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(x){return new _(this.r,this.s,x)}recoverPublicKey(x){const{r:M,s:J,recovery:Y}=this,G=H(qe("msgHash",x));if(Y==null||![0,1,2,3].includes(Y))throw new Error("recovery id invalid");const ee=Y===2||Y===3?M+t.n:M;if(ee>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const he=Y&1?"03":"02",L=c.fromHex(he+A(ee)),oe=l(ee),ge=u(-G*oe),we=u(J*oe),_e=c.BASE.multiplyAndAddUnsafe(L,ge,we);if(!_e)throw new Error("point at infinify");return _e.assertValidity(),_e}hasHighS(){return R(this.s)}normalizeS(){return this.hasHighS()?new _(this.r,u(-this.s),this.recovery):this}toDERRawBytes(){return Vt(this.toDERHex())}toDERHex(){return At.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Vt(this.toCompactHex())}toCompactHex(){return A(this.r)+A(this.s)}}const T={isValidPrivateKey(I){try{return p(I),!0}catch{return!1}},normPrivateKeyToScalar:p,randomPrivateKey:()=>{const I=ka(t.n);return Of(t.randomBytes(I),t.n)},precompute(I=8,x=c.BASE){return x._setWindowSize(I),x.multiply(BigInt(3)),x}};function S(I,x=!0){return c.fromPrivateKey(I).toRawBytes(x)}function F(I){const x=Ot(I),M=typeof I=="string",J=(x||M)&&I.length;return x?J===o||J===i:M?J===2*o||J===2*i:I instanceof c}function k(I,x,M=!0){if(F(I))throw new Error("first arg must be private key");if(!F(x))throw new Error("second arg must be public key");return c.fromHex(x).multiply(p(I)).toRawBytes(M)}const C=t.bits2int||function(I){const x=It(I),M=I.length*8-t.nBitLength;return M>0?x>>BigInt(M):x},H=t.bits2int_modN||function(I){return u(C(I))},U=Ho(t.nBitLength);function Q(I){if(typeof I!="bigint")throw new Error("bigint expected");if(!(nt<=I&&I<U))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Gt(I,t.nByteLength)}function Z(I,x,M=B){if(["recovered","canonical"].some(Ae=>Ae in M))throw new Error("sign() legacy options not supported");const{hash:J,randomBytes:Y}=t;let{lowS:G,prehash:ee,extraEntropy:he}=M;G==null&&(G=!0),I=qe("msgHash",I),ee&&(I=qe("prehashed msgHash",J(I)));const L=H(I),oe=p(x),ge=[Q(oe),Q(L)];if(he!=null&&he!==!1){const Ae=he===!0?Y(r.BYTES):he;ge.push(qe("extraEntropy",Ae))}const we=mr(...ge),_e=L;function Ee(Ae){const Pe=C(Ae);if(!g(Pe))return;const xe=l(Pe),be=c.BASE.multiply(Pe).toAffine(),w=u(be.x);if(w===nt)return;const v=u(xe*u(_e+w*oe));if(v===nt)return;let O=(be.x===w?0:2)|Number(be.y&Me),$=v;return G&&R(v)&&($=h(v),O^=1),new _(w,$,O)}return{seed:we,k2sig:Ee}}const B={lowS:t.lowS,prehash:!1},D={lowS:t.lowS,prehash:!1};function N(I,x,M=B){const{seed:J,k2sig:Y}=Z(I,x,M),G=t;return Pa(G.hash.outputLen,G.nByteLength,G.hmac)(J,Y)}c.BASE._setWindowSize(8);function X(I,x,M,J=D){var Y;const G=I;if(x=qe("msgHash",x),M=qe("publicKey",M),"strict"in J)throw new Error("options.strict was renamed to lowS");const{lowS:ee,prehash:he}=J;let L,oe;try{if(typeof G=="string"||Ot(G))try{L=_.fromDER(G)}catch(be){if(!(be instanceof At.Err))throw be;L=_.fromCompact(G)}else if(typeof G=="object"&&typeof G.r=="bigint"&&typeof G.s=="bigint"){const{r:be,s:w}=G;L=new _(be,w)}else throw new Error("PARSE");oe=c.fromHex(M)}catch(be){if(be.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(ee&&L.hasHighS())return!1;he&&(x=t.hash(x));const{r:ge,s:we}=L,_e=H(x),Ee=l(we),Ae=u(_e*Ee),Pe=u(ge*Ee),xe=(Y=c.BASE.multiplyAndAddUnsafe(oe,Ae,Pe))==null?void 0:Y.toAffine();return xe?u(xe.x)===ge:!1}return{CURVE:t,getPublicKey:S,getSharedSecret:k,sign:N,verify:X,ProjectivePoint:c,Signature:_,utils:T}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Mf(e){return{hash:e,hmac:(t,...r)=>Ia(e,t,Qd(...r)),randomBytes:ef}}function Df(e,t){const r=n=>Bf({...e,...Mf(n)});return Object.freeze({...r(t),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ja=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),gs=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Uf=BigInt(1),vo=BigInt(2),bs=(e,t)=>(e+t/vo)/t;function Wf(e){const t=ja,r=BigInt(3),n=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),u=BigInt(44),l=BigInt(88),c=e*e*e%t,p=c*c*e%t,y=Be(p,r,t)*p%t,g=Be(y,r,t)*p%t,A=Be(g,vo,t)*c%t,R=Be(A,o,t)*A%t,h=Be(R,i,t)*R%t,b=Be(h,u,t)*h%t,_=Be(b,l,t)*b%t,T=Be(_,u,t)*h%t,S=Be(T,r,t)*p%t,F=Be(S,s,t)*R%t,k=Be(F,n,t)*c%t,C=Be(k,vo,t);if(!So.eql(So.sqr(C),e))throw new Error("Cannot find square root");return C}const So=Tf(ja,void 0,void 0,{sqrt:Wf}),zo=Df({a:BigInt(0),b:BigInt(7),Fp:So,n:gs,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=gs,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Uf*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,s=BigInt("0x100000000000000000000000000000000"),u=bs(i*e,t),l=bs(-n*e,t);let c=Oe(e-u*r-l*o,t),p=Oe(-u*n-l*i,t);const y=c>s,g=p>s;if(y&&(c=t-c),g&&(p=t-p),c>s||p>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:y,k1:c,k2neg:g,k2:p}}}},lf);BigInt(0);zo.ProjectivePoint;function Ff(e){let t=e;if(typeof t!="string")throw new Error(`[padToEven] value must be type 'string', received ${typeof t}`);return t.length%2&&(t=`0${t}`),t}BigInt(0);const Eo={},Ao={};for(let e=0;e<16;e++){const t=e,r=e*16,n=e.toString(16).toLowerCase();Ao[n]=t,Ao[n.toUpperCase()]=t,Eo[n]=r,Eo[n.toUpperCase()]=r}function $f(e){const t=e.length,r=new Uint8Array(t/2);for(let n=0;n<t;n+=2)r[n/2]=Eo[e[n]]+Ao[e[n+1]];return r}Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));for(let e=0;e<=256*256-1;e++)BigInt(e);const mn=e=>{if(typeof e!="string")throw new Error(`hex argument type ${typeof e} must be of type string`);if(!/^0x[0-9a-fA-F]*$/.test(e))throw new Error(`Input must be a 0x-prefixed hexadecimal string, got ${e}`);const t=e.slice(2);return $f(t.length%2===0?t:Ff(t))},qf=e=>{if(!Number.isSafeInteger(e)||e<0)throw new Error(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`},Er=e=>{const t=qf(e);return mn(t)};BigInt("0xffffffffffffffff");BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935");zo.CURVE.n;zo.CURVE.n/BigInt(2);BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");const Hf="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";mn(Hf);const zf="0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347";mn(zf);const Vf="0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421";mn(Vf);Uint8Array.from([128]);BigInt(-1);BigInt(0);BigInt(1);BigInt(2);BigInt(3);BigInt(7);BigInt(8);BigInt(27);BigInt(28);BigInt(31);BigInt(32);BigInt(64);BigInt(128);BigInt(255);BigInt(256);BigInt(96);BigInt(100);BigInt(160);BigInt(224);BigInt(7922816251426434e13);BigInt(1461501637330903e33);BigInt(2695994666715064e52);BigInt(1e9);Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));var ms;(function(e){e.String="string",e.Bytes="view",e.Number="number"})(ms||(ms={}));var ys;(function(e){e.String="string",e.Bytes="view",e.JSON="json"})(ys||(ys={}));var ws;(function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Uint8Array=2]="Uint8Array",e[e.PrefixedHexString=3]="PrefixedHexString"})(ws||(ws={}));var _s;(function(e){e[e.Deposit=0]="Deposit",e[e.Withdrawal=1]="Withdrawal",e[e.Consolidation=2]="Consolidation"})(_s||(_s={}));var Pt;(function(e){e[e.Version=0]="Version",e[e.Balance=1]="Balance",e[e.Nonce=2]="Nonce",e[e.CodeHash=3]="CodeHash",e[e.CodeSize=4]="CodeSize"})(Pt||(Pt={}));Er(Pt.Version);Er(Pt.Balance);Er(Pt.Nonce);Er(Pt.CodeHash);Er(Pt.CodeSize);BigInt(256)**BigInt(31);var Gf={exports:{}},Vo={},Go={};Object.defineProperty(Go,"__esModule",{value:!0});function Kf(e){var t=4,r=e.length,n=r%t;if(!n)return e;var o=r,i=t-n,s=r+i,u=Le.Buffer.alloc(s);for(u.write(e);i--;)u.write("=",o++);return u.toString()}Go.default=Kf;Object.defineProperty(Vo,"__esModule",{value:!0});var Jf=Go;function Ca(e,t){return t===void 0&&(t="utf8"),Le.Buffer.isBuffer(e)?Ro(e.toString("base64")):Ro(Le.Buffer.from(e,t).toString("base64"))}function Zf(e,t){return t===void 0&&(t="utf8"),Le.Buffer.from(Ko(e),"base64").toString(t)}function Ko(e){return e=e.toString(),Jf.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function Ro(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Yf(e){return Le.Buffer.from(Ko(e),"base64")}var Zt=Ca;Zt.encode=Ca;Zt.decode=Zf;Zt.toBase64=Ko;Zt.fromBase64=Ro;Zt.toBuffer=Yf;Vo.default=Zt;(function(e){e.exports=Vo.default,e.exports.default=e.exports})(Gf);const le={MAINNET:"mainnet",TESTNET:"testnet",CYAN:"cyan",AQUA:"aqua",CELESTE:"celeste"},ft={SAPPHIRE_DEVNET:"sapphire_devnet",SAPPHIRE_MAINNET:"sapphire_mainnet"};le.MAINNET+"",le.TESTNET+"",le.CYAN+"",le.AQUA+"",le.CELESTE+"";le.AQUA+"",ft.SAPPHIRE_MAINNET,le.CELESTE+"",ft.SAPPHIRE_MAINNET,le.CYAN+"",ft.SAPPHIRE_MAINNET,le.MAINNET+"",ft.SAPPHIRE_MAINNET,le.TESTNET+"",ft.SAPPHIRE_DEVNET;le.MAINNET+"",le.TESTNET+"",le.CYAN+"",le.AQUA+"",le.CELESTE+"";ft.SAPPHIRE_MAINNET+"",ft.SAPPHIRE_DEVNET+"",le.MAINNET+"",le.TESTNET+"",le.CYAN+"",le.AQUA+"",le.CELESTE+"";le.MAINNET+"",le.TESTNET+"",le.CYAN+"",le.AQUA+"",le.CELESTE+"";function vs(e){let t=!1,r=0,n;try{n=window[e],t=!0,r=n.length;const o="__storage_test__";return n.setItem(o,o),n.removeItem(o),!0}catch(o){const i=o;return i&&(i.code===22||i.code===1014||i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&r!==0}}class Qf{constructor(){z(this,"store",new Map)}getItem(t){return this.store.get(t)||null}setItem(t,r){this.store.set(t,r)}removeItem(t){this.store.delete(t)}}class Xf{constructor(t,r){z(this,"storage",void 0),z(this,"_storeKey",void 0),this.storage=r,this._storeKey=t;try{r.getItem(t)||this.resetStore()}catch{}}static getInstance(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"local";if(!this.instanceMap.has(t)){let n;r==="local"&&vs("localStorage")?n=window.localStorage:r==="session"&&vs("sessionStorage")?n=window.sessionStorage:n=new Qf,this.instanceMap.set(t,new this(t,n))}return this.instanceMap.get(t)}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const t=this.getStore();return this.storage.removeItem(this._storeKey),t}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(t){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")[t]}set(t,r){const n=JSON.parse(this.storage.getItem(this._storeKey)||"{}");n[t]=r,this.storage.setItem(this._storeKey,JSON.stringify(n))}}z(Xf,"instanceMap",new Map);De(De({},ft),le);const $r={IFRAME_STATUS:"iframe_status",CLOSE_WINDOW:"close_window",USER_LOGGED_IN:"user_logged_in",USER_LOGGED_OUT:"user_logged_out"},ot={LOGOUT:"logout",WALLET_INSTANCE_ID:"wallet_instance_id",USER_INFO:"user_info",SET_PROVIDER:"set_provider",TOPUP:"topup",IFRAME_STATUS:"iframe_status",CLOSED_WINDOW:"closed_window",WINDOW_BLOCKED:"window_blocked",GET_PROVIDER_STATE:"get_provider_state",LOGIN_WITH_PRIVATE_KEY:"login_with_private_key",SHOW_WALLET_CONNECT:"show_wallet_connect",SHOW_CHECKOUT:"show_checkout",SHOW_WALLET_UI:"show_wallet_ui",LOGIN_WITH_SESSION_ID:"login_with_session_id"},eh={GET_PROVIDER_STATE:"wallet_get_provider_state"},oo={ACCOUNTS_CHANGED:"wallet_accounts_changed",CHAIN_CHANGED:"wallet_chain_changed",UNLOCK_STATE_CHANGED:"wallet_unlock_state_changed"};function th(e){return function(t,r,n){n(o=>{r.error&&Xr.warn(`Error in RPC response:
`,r),!t.isTorusInternal&&(Xr.info(`RPC (${e.origin}):`,t,"->",r),o())})}}var rh=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(i=Object.keys(t),n=i.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;o--!==0;){var s=i[o];if(!e(t[s],r[s]))return!1}return!0}return t!==t&&r!==r};const nh=Kt(rh);var oh="2.1.0";function Ba(e){return e!==null&&typeof e=="object"&&typeof e.pipe=="function"}function ih(e){return Ba(e)&&e.writable!==!1&&typeof e._write=="function"&&typeof e._writableState=="object"}function sh(e){return Ba(e)&&e.readable!==!1&&typeof e._read=="function"&&typeof e._readableState=="object"}function ah(e){return ih(e)&&sh(e)}var Ve={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",unsupportedSync:e=>`Torus: The Torus Ethereum provider does not support synchronous methods like ${e} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:e=>`Invalid options. Received: { maxEventListeners: ${e}}`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:e=>`'args.logger' must include required method '${e}'.`},info:{connected:e=>`Torus: Connected to chain with ID "${e}".`}};const lh={PRODUCTION:"production"},cr={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},uh={en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies bentigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"",actionRequired:"",pendingAction:"",cookiesRequired:"",enableCookies:"TorusCookie",clickHere:""}},ko:{embed:{continue:"",actionRequired:" ",pendingAction:"    .",cookiesRequired:" ",enableCookies:"     Torus .",clickHere:"  "}},zh:{embed:{continue:"",actionRequired:"",pendingAction:"",cookiesRequired:"Cookie",enableCookies:"cookieTorus",clickHere:""}}};var Jo={translations:uh,localStorageKeyPrefix:"torus-"},se=Xr.getLogger("solana-embed");function ch(){return(e,t,r)=>{(typeof e.method!="string"||!e.method)&&(t.error=it.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:e})),r(n=>{const{error:o}=t;return o&&se.error(`Torus - RPC Error: ${o.message}`,o),n()})}}function dh(e,t,r){let n=`Torus: Lost connection to "${e}".`;t!=null&&t.stack&&(n+=`
${t.stack}`),se.warn(n),r&&r.listenerCount("error")>0&&r.emit("error",n)}const qr=()=>Math.random().toString(36).slice(2),Ma=async e=>{let t,r;switch(e){case"testing":t="https://solana-testing.tor.us",r="debug";break;case"development":t="http://localhost:8080",r="debug";break;default:t="https://solana.tor.us",r="error";break}return{torusUrl:t,logLevel:r}},fh=()=>{let e=window.navigator.language||"en-US";const t=e.split("-");return e=Object.prototype.hasOwnProperty.call(Jo.translations,t[0])?t[0]:"en",e},hh={height:660,width:375},ph={height:740,width:1315},gh={height:700,width:1200},Da={height:600,width:400};function bh(e){let t;try{t=window[e];const r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(r){const n=r;return n&&(n.code===22||n.code===1014||n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&t.length!==0}}function fr(e){let{width:t,height:r}=e;const n=window.screenLeft!==void 0?window.screenLeft:window.screenX,o=window.screenTop!==void 0?window.screenTop:window.screenY,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,s=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,u=1,l=Math.abs((i-t)/2/u+n),c=Math.abs((s-r)/2/u+o);return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${r/u},width=${t/u},top=${c},left=${l}`}class Ua extends pn{constructor(t,r){let{maxEventListeners:n=100,jsonRpcStreamName:o="provider"}=r;if(super(),z(this,"isTorus",void 0),z(this,"_rpcEngine",void 0),z(this,"jsonRpcConnectionEvents",void 0),z(this,"_state",void 0),!ah(t))throw new Error(Ve.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(n),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.sendAsync=this.sendAsync.bind(this);const i=new zd;Yi(t,i,t,this._handleStreamDisconnect.bind(this,"Torus")),i.ignoreStream("phishing");const s=$d();Yi(s.stream,i.createStream(o),s.stream,this._handleStreamDisconnect.bind(this,"Torus RpcProvider"));const u=new rt;u.push(qd()),u.push(ch()),u.push(th({origin:location.origin})),u.push(s.middleware),this._rpcEngine=u,this.jsonRpcConnectionEvents=s.events}async request(t){if(!t||typeof t!="object"||Array.isArray(t))throw it.ethErrors.rpc.invalidRequest({message:Ve.errors.invalidRequestArgs(),data:t});const{method:r,params:n}=t;if(typeof r!="string"||r.length===0)throw it.ethErrors.rpc.invalidRequest({message:Ve.errors.invalidRequestMethod(),data:t});if(n!==void 0&&!Array.isArray(n)&&(typeof n!="object"||n===null))throw it.ethErrors.rpc.invalidRequest({message:Ve.errors.invalidRequestParams(),data:t});return new Promise((o,i)=>{this._rpcRequest({method:r,params:n},yo(o,i))})}send(t,r){this._rpcRequest(t,r)}sendAsync(t){return new Promise((r,n)=>{this._rpcRequest(t,yo(r,n))})}_handleStreamDisconnect(t,r){dh(t,r,this),this._handleDisconnect(!1,r?r.message:void 0)}}const $t=e=>{const t=window.document.createElement("template"),r=e.trim();return t.innerHTML=r,t.content.firstChild};function Hr(e){return e.version===void 0}class Wa extends pn{constructor(t){let{url:r,target:n,features:o,timeout:i=3e4}=t;super(),z(this,"url",void 0),z(this,"target",void 0),z(this,"features",void 0),z(this,"window",void 0),z(this,"windowTimer",void 0),z(this,"iClosedWindow",void 0),z(this,"timeout",void 0),this.url=r,this.target=n||"_blank",this.features=o||fr(gh),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=i,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),this.window===void 0&&clearInterval(this.windowTimer)},500))}open(){var t;return this.window=window.open(this.url.href,this.target,this.features),(t=this.window)!=null&&t.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(t){t?window.location.replace(this.url.href):window.location.href=this.url.href}}class yn extends Ua{constructor(t,r){let{maxEventListeners:n=100,jsonRpcStreamName:o="provider"}=r;super(t,{maxEventListeners:n,jsonRpcStreamName:o}),z(this,"embedTranslations",void 0),z(this,"torusUrl",void 0),z(this,"dappStorageKey",void 0),z(this,"windowRefs",void 0),z(this,"tryWindowHandle",void 0),z(this,"torusAlertContainer",void 0),z(this,"torusIframe",void 0),this._state=De({},yn._defaultState),this.torusUrl="",this.dappStorageKey="";const i=Jo.translations[fh()];this.embedTranslations=i.embed,this.windowRefs={},this.on("connect",()=>{this._state.isConnected=!0});const s=u=>{const{method:l,params:c}=u;if(l===$r.IFRAME_STATUS){const{isFullScreen:p,rid:y}=c;this._displayIframe({isFull:p,rid:y})}else if(l==="create_window"){const{windowId:p,url:y}=c;this._createPopupBlockAlert(p,y)}else if(l===$r.CLOSE_WINDOW)this._handleCloseWindow(c);else if(l===$r.USER_LOGGED_IN){const{currentLoginProvider:p}=c;this._state.isLoggedIn=!0,this._state.currentLoginProvider=p}else l===$r.USER_LOGGED_OUT&&(this._state.isLoggedIn=!1,this._state.currentLoginProvider=null,this._displayIframe())};this.jsonRpcConnectionEvents.on("notification",s)}get isLoggedIn(){return this._state.isLoggedIn}get isIFrameFullScreen(){return this._state.isIFrameFullScreen}isConnected(){return this._state.isConnected}async _initializeState(t){try{const{torusUrl:r,dappStorageKey:n,torusAlertContainer:o,torusIframe:i}=t;this.torusUrl=r,this.dappStorageKey=n,this.torusAlertContainer=o,this.torusIframe=i,this.torusIframe.addEventListener("load",()=>{this._state.isIFrameFullScreen||this._displayIframe()});const{currentLoginProvider:s,isLoggedIn:u}=await this.request({method:ot.GET_PROVIDER_STATE,params:[]});this._handleConnect(s,u)}catch(r){se.error("Torus: Failed to get initial state. Please report this bug.",r)}finally{se.info("initialized communication state"),this._state.initialized=!0,this.emit("_initialized")}}_handleWindow(t){let{url:r,target:n,features:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=new URL(r||`${this.torusUrl}/redirect?windowId=${t}`);this.dappStorageKey&&(i.hash?i.hash+=`&dappStorageKey=${this.dappStorageKey}`:i.hash=`#dappStorageKey=${this.dappStorageKey}`);const s=new Wa({url:i,target:n,features:o});if(s.open(),!s.window){this._createPopupBlockAlert(t,i.href);return}this.windowRefs[t]=s,this.request({method:"opened_window",params:{windowId:t}}),s.once("close",()=>{delete this.windowRefs[t],this.request({method:ot.CLOSED_WINDOW,params:{windowId:t}})})}_displayIframe(){let{isFull:t=!1,rid:r=""}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={};if(t)n.display="block",n.width="100%",n.height="100%",n.top="0px",n.right="0px",n.left="0px",n.bottom="0px";else switch(n.display=this._state.torusWidgetVisibility?"block":"none",n.height="70px",n.width="70px",this._state.buttonPosition){case cr.TOP_LEFT:n.top="0px",n.left="0px",n.right="auto",n.bottom="auto";break;case cr.TOP_RIGHT:n.top="0px",n.right="0px",n.left="auto",n.bottom="auto";break;case cr.BOTTOM_RIGHT:n.bottom="0px",n.right="0px",n.top="auto",n.left="auto";break;case cr.BOTTOM_LEFT:default:n.bottom="0px",n.left="0px",n.top="auto",n.right="auto";break}Object.assign(this.torusIframe.style,n),this._state.isIFrameFullScreen=t,this.request({method:ot.IFRAME_STATUS,params:{isIFrameFullScreen:t,rid:r}})}hideTorusButton(){this._state.torusWidgetVisibility=!1,this._displayIframe()}showTorusButton(){this._state.torusWidgetVisibility=!0,this._displayIframe()}_rpcRequest(t,r){const n=r,o=t;Array.isArray(o)||o.jsonrpc||(o.jsonrpc="2.0"),this.tryWindowHandle(o,n)}_handleConnect(t,r){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{currentLoginProvider:t,isLoggedIn:r}),se.debug(Ve.info.connected(t)))}_handleDisconnect(t,r){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!t){this._state.isConnected=!1;let n;t?(n=new it.EthereumRpcError(1013,r||Ve.errors.disconnected()),se.debug(n)):(n=new it.EthereumRpcError(1011,r||Ve.errors.permanentlyDisconnected()),se.error(n),this._state.currentLoginProvider=null,this._state.isLoggedIn=!1,this._state.torusWidgetVisibility=!1,this._state.isIFrameFullScreen=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",n)}}_handleCloseWindow(t){const{windowId:r}=t;this.windowRefs[r]&&(this.windowRefs[r].close(),delete this.windowRefs[r])}async _createPopupBlockAlert(t,r){const n=this.getLogoUrl(),o=$t(`<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="${n}" /></div><div><h1 id="torusAlert__title">${this.embedTranslations.actionRequired}</h1><p id="torusAlert__desc">${this.embedTranslations.pendingAction}</p></div></div>`),i=$t(`<div><a id="torusAlert__btn">${this.embedTranslations.continue}</a></div>`),s=$t('<div id="torusAlert__btn-container"></div>');s.appendChild(i),o.appendChild(s);const u=()=>{i.addEventListener("click",()=>{this._handleWindow(t,{url:r,target:"_blank",features:fr(Da)}),o.remove(),this.torusAlertContainer.children.length===0&&(this.torusAlertContainer.style.display="none")})};this.torusAlertContainer.appendChild(o),u(),this.torusAlertContainer.style.display="block"}getLogoUrl(){return`${this.torusUrl}/images/torus_icon-blue.svg`}}z(yn,"_defaultState",{buttonPosition:"bottom-left",currentLoginProvider:null,isIFrameFullScreen:!1,hasEmittedConnection:!1,torusWidgetVisibility:!1,initialized:!1,isLoggedIn:!1,isPermanentlyDisconnected:!1,isConnected:!1});class wn extends Ua{constructor(t,r){let{maxEventListeners:n=100,jsonRpcStreamName:o="provider"}=r;super(t,{maxEventListeners:n,jsonRpcStreamName:o}),z(this,"chainId",void 0),z(this,"selectedAddress",void 0),z(this,"tryWindowHandle",void 0),this._state=De({},wn._defaultState),this.selectedAddress=null,this.chainId=null,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this.on("connect",()=>{this._state.isConnected=!0});const i=s=>{const{method:u,params:l}=s;u===oo.ACCOUNTS_CHANGED?this._handleAccountsChanged(l):u===oo.UNLOCK_STATE_CHANGED?this._handleUnlockStateChanged(l):u===oo.CHAIN_CHANGED&&this._handleChainChanged(l)};this.jsonRpcConnectionEvents.on("notification",i)}isConnected(){return this._state.isConnected}async _initializeState(){try{const{accounts:t,chainId:r,isUnlocked:n}=await this.request({method:eh.GET_PROVIDER_STATE,params:[]});this.emit("connect",{chainId:r}),this._handleChainChanged({chainId:r}),this._handleUnlockStateChanged({accounts:t,isUnlocked:n}),this._handleAccountsChanged(t)}catch(t){se.error("Torus: Failed to get initial state. Please report this bug.",t)}finally{se.info("initialized provider state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=r;const i=t;if(!Array.isArray(i)){if(i.jsonrpc||(i.jsonrpc="2.0"),i.method==="solana_accounts"||i.method==="solana_requestAccounts")o=(s,u)=>{this._handleAccountsChanged(u.result||[],i.method==="solana_accounts",n),r(s,u)};else if(i.method==="wallet_getProviderState"){this._rpcEngine.handle(t,o);return}}this.tryWindowHandle(i,o)}_handleConnect(t){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:t}),se.debug(Ve.info.connected(t)))}_handleDisconnect(t,r){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!t){this._state.isConnected=!1;let n;t?(n=new it.EthereumRpcError(1013,r||Ve.errors.disconnected()),se.debug(n)):(n=new it.EthereumRpcError(1011,r||Ve.errors.permanentlyDisconnected()),se.error(n),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",n)}}_handleAccountsChanged(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=t;Array.isArray(o)||(se.error("Torus: Received non-array accounts parameter. Please report this bug.",o),o=[]);for(const i of t)if(typeof i!="string"){se.error("Torus: Received non-string account. Please report this bug.",t),o=[];break}nh(this._state.accounts,o)||(r&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!n&&se.error('Torus: "solana_accounts" unexpectedly updated accounts. Please report this bug.',o),this._state.accounts=o,this.emit("accountsChanged",o)),this.selectedAddress!==o[0]&&(this.selectedAddress=o[0]||null)}_handleChainChanged(){let{chainId:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!t){se.error("Torus: Received invalid network parameters. Please report this bug.",{chainId:t});return}t==="loading"?this._handleDisconnect(!0):(this._handleConnect(t),t!==this.chainId&&(this.chainId=t,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts:t,isUnlocked:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof r!="boolean"){se.error("Torus: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:r});return}r!==this._state.isUnlocked&&(this._state.isUnlocked=r,this._handleAccountsChanged(t||[]))}}z(wn,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});function Ss(e){return new Promise((t,r)=>{try{const n=document.createElement("img");n.onload=()=>t(!0),n.onerror=()=>t(!1),n.src=e}catch(n){r(n)}})}const mh=e=>{const{document:t}=e,r=t.querySelector('head > meta[property="og:site_name"]');if(r)return r.content;const n=t.querySelector('head > meta[name="title"]');return n?n.content:t.title&&t.title.length>0?t.title:e.location.hostname};async function yh(e){try{const{document:t}=e;let r=t.querySelector('head > link[rel="shortcut icon"]');return r&&await Ss(r.href)||(r=Array.from(t.querySelectorAll('head > link[rel="icon"]')).find(n=>!!n.href),r&&await Ss(r.href))?r.href:""}catch{return""}}const wh=async()=>({name:mh(window),icon:await yh(window)}),_h=["send_transaction","sign_transaction","sign_all_transactions","sign_message","connect"],vh=[ot.SET_PROVIDER],Sh=bh("localStorage");(async function(){try{if(typeof document>"u")return;const e=document.createElement("link"),{torusUrl:t}=await Ma("production");e.href=`${t}/frame`,e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){se.warn(e)}})();class kh{constructor(){let{modalZIndex:t=99999}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};z(this,"isInitialized",void 0),z(this,"torusAlert",void 0),z(this,"modalZIndex",void 0),z(this,"alertZIndex",void 0),z(this,"requestedLoginProvider",void 0),z(this,"provider",void 0),z(this,"communicationProvider",void 0),z(this,"dappStorageKey",void 0),z(this,"isTopupHidden",!1),z(this,"torusAlertContainer",void 0),z(this,"torusUrl",void 0),z(this,"torusIframe",void 0),z(this,"styleLink",void 0),this.torusUrl="",this.isInitialized=!1,this.requestedLoginProvider=null,this.modalZIndex=t,this.alertZIndex=t+1e3,this.dappStorageKey=""}get isLoggedIn(){return this.communicationProvider?this.communicationProvider.isLoggedIn:!1}async init(){let{buildEnv:t=lh.PRODUCTION,enableLogging:r=!1,network:n,showTorusButton:o=!1,useLocalStorage:i=!1,buttonPosition:s=cr.BOTTOM_LEFT,apiKey:u="torus-default",extraParams:l={},whiteLabel:c}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");const{torusUrl:p,logLevel:y}=await Ma(t);se.enableAll(),se.info(p,"url loaded"),se.info(`Solana Embed Version :${oh}`),this.torusUrl=p,se.setDefaultLevel(y),r?se.enableAll():se.disableAll();const g=this.handleDappStorageKey(i),A=new URL(p);A.pathname.endsWith("/")?A.pathname+="frame":A.pathname+="/frame";const R=new URLSearchParams;return g&&R.append("dappStorageKey",g),R.append("origin",window.location.origin),A.hash=R.toString(),this.torusIframe=$t(`<iframe
        id="torusIframe"
        class="torusIframe"
        src="${A.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex.toString()}"
      ></iframe>`),this.torusAlertContainer=$t(`<div id="torusAlertContainer" style="display:none; z-index: ${this.alertZIndex.toString()}"></div>`),this.styleLink=$t(`<link href="${p}/css/widget.css" rel="stylesheet" type="text/css">`),new Promise((h,b)=>{try{this.torusIframe.addEventListener("load",async()=>{const _=await wh();this.torusIframe.contentWindow.postMessage({buttonPosition:s,apiKey:u,network:n,dappMetadata:_,extraParams:l,whiteLabel:c},A.origin),await this._setupWeb3({torusUrl:p}),o&&this.showTorusButton(),c!=null&&c.topupHide?this.isTopupHidden=c.topupHide:this.hideTorusButton(),this.isInitialized=!0,window.torus=this,h()}),window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)}catch(_){b(_)}})}async login(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");try{this.requestedLoginProvider=t.loginProvider||null,this.requestedLoginProvider||this.communicationProvider._displayIframe({isFull:!0});const r=await new Promise((n,o)=>{this.provider._rpcRequest({method:"solana_requestAccounts",params:[this.requestedLoginProvider,t.login_hint]},yo(n,o))});if(Array.isArray(r)&&r.length>0)return r;throw new Error("Login failed")}catch(r){throw se.error("login failed",r),r}finally{this.communicationProvider.isIFrameFullScreen&&this.communicationProvider._displayIframe()}}async loginWithPrivateKey(t){if(!this.isInitialized)throw new Error("Call init() first");const{privateKey:r,userInfo:n}=t,{success:o}=await this.communicationProvider.request({method:"login_with_private_key",params:{privateKey:r,userInfo:n}});if(!o)throw new Error("Login Failed")}async logout(){if(!this.communicationProvider.isLoggedIn)throw new Error("Not logged in");await this.communicationProvider.request({method:ot.LOGOUT,params:[]}),this.requestedLoginProvider=null}async cleanUp(){this.communicationProvider.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function t(r){return r instanceof Element||r instanceof Document}t(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),t(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),t(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.communicationProvider.hideTorusButton()}showTorusButton(){this.communicationProvider.showTorusButton()}async setProvider(t){await this.communicationProvider.request({method:ot.SET_PROVIDER,params:De({},t)})}async showWallet(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=await this.communicationProvider.request({method:ot.WALLET_INSTANCE_ID,params:[]}),o=t?`/${t}`:"",i=new URL(`${this.torusUrl}/wallet${o}`);i.searchParams.append("instanceId",n),Object.keys(r).forEach(s=>{i.searchParams.append(s,r[s])}),this.dappStorageKey&&(i.hash=`#dappStorageKey=${this.dappStorageKey}`),new Wa({url:i,features:fr(ph)}).open()}async getUserInfo(){return await this.communicationProvider.request({method:ot.USER_INFO,params:[]})}async initiateTopup(t,r){if(!this.isInitialized)throw new Error("Torus is not initialized");const n=qr();return this.communicationProvider._handleWindow(n),await this.communicationProvider.request({method:ot.TOPUP,params:{provider:t,params:r,windowId:n}})}async getAccounts(){return await this.provider.request({method:"getAccounts",params:[]})}async sendTransaction(t){const r=Hr(t),n=r?t.serialize({requireAllSignatures:!1}).toString("hex"):Le.Buffer.from(t.serialize()).toString("hex");return await this.provider.request({method:"send_transaction",params:{message:n,isLegacyTransaction:r}})}async signAndSendTransaction(t,r){const n=Hr(t),o=n?t.serialize({requireAllSignatures:!1}).toString("hex"):Le.Buffer.from(t.serialize()).toString("hex");return{signature:await this.provider.request({method:"send_transaction",params:{message:o,options:r,isLegacyTransaction:n}})}}async signTransaction(t){const r=Hr(t),n=r?t.serializeMessage().toString("hex"):Le.Buffer.from(t.message.serialize()).toString("hex"),o=await this.provider.request({method:"sign_transaction",params:{message:n,messageOnly:!0,isLegacyTransaction:r}}),i=JSON.parse(o),s={publicKey:new si(i.publicKey),signature:Le.Buffer.from(i.signature,"hex")};return t.addSignature(s.publicKey,s.signature),t}async signAllTransactions(t){let r;const n=t.map(i=>(r=Hr(i),r?i.serializeMessage().toString("hex"):Le.Buffer.from(i.message.serialize()).toString("hex"))),o=(await this.provider.request({method:"sign_all_transactions",params:{message:n,messageOnly:!0,isLegacyTransaction:r}})).map(i=>{const s=JSON.parse(i);return{publicKey:new si(s.publicKey),signature:Le.Buffer.from(s.signature,"hex")}});return t.forEach((i,s)=>(i.addSignature(o[s].publicKey,o[s].signature),i)),t}async signMessage(t){return await this.provider.request({method:"sign_message",params:{data:t}})}async getGaslessPublicKey(){return await this.provider.request({method:"get_gasless_public_key",params:[]})}handleDappStorageKey(t){const r=`${Jo.localStorageKeyPrefix}${window.location.hostname}`;let n="";if(Sh&&t){const o=window.localStorage.getItem(r);if(o)n=o;else{const i=`torus-app-${qr()}`;window.localStorage.setItem(r,i),n=i}}return this.dappStorageKey=n,n}async _setupWeb3(t){se.info("setupWeb3 running");const r=new es({name:"embed_torus",target:"iframe_torus",targetWindow:this.torusIframe.contentWindow}),n=new es({name:"embed_communication",target:"iframe_communication",targetWindow:this.torusIframe.contentWindow}),o=new wn(r,{}),i=new yn(n,{});o.tryWindowHandle=(c,p)=>{const y=c;if(!Array.isArray(y)&&_h.includes(y.method)){if(!this.communicationProvider.isLoggedIn)throw new Error("User Not Logged In");const g=qr();i._handleWindow(g,{target:"_blank",features:fr(Da)}),y.windowId=g}o._rpcEngine.handle(y,p)},i.tryWindowHandle=(c,p)=>{const y=c;if(!Array.isArray(y)&&vh.includes(y.method)){const g=qr();i._handleWindow(g,{target:"_blank",features:fr(hh)}),y.params.windowId=g}i._rpcEngine.handle(y,p)};const s=c=>{const p=o[c],y=this;o[c]=function(g,A){const{method:R,params:h=[]}=g;if(R==="solana_requestAccounts"){if(!A)return y.login({loginProvider:h[0]});y.login({loginProvider:h[0]}).then(b=>A(null,b)).catch(b=>A(b))}return p.apply(this,[g,A])}};s("request"),s("sendAsync"),s("send");const u=new Proxy(o,{deleteProperty:()=>!0}),l=new Proxy(i,{deleteProperty:()=>!0});this.provider=u,this.communicationProvider=l,await Promise.all([o._initializeState(),i._initializeState(De(De({},t),{},{dappStorageKey:this.dappStorageKey,torusAlertContainer:this.torusAlertContainer,torusIframe:this.torusIframe}))]),se.debug("Torus - injected provider")}}export{cr as BUTTON_POSITION,lh as TORUS_BUILD_ENV,wn as TorusInPageProvider,kh as default};
