import{ch as b,ci as g,co as F,cp as R,bz as w,cq as L,ax as A,by as D}from"./index-BGLdF6jF.js";function P(n,t,e,c){F(n);const a=R({dkLen:32,asyncTick:10},c),{c:u,dkLen:i,asyncTick:o}=a;if(w(u),w(i),w(o),u<1)throw new Error("iterations (c) should be >= 1");const d=L(t),s=L(e),f=new Uint8Array(i),l=A.create(n,d),r=l._cloneInto().update(s);return{c:u,dkLen:i,asyncTick:o,DK:f,PRF:l,PRFSalt:r}}function T(n,t,e,c,a){return n.destroy(),t.destroy(),c&&c.destroy(),D(a),e}function U(n,t,e,c){const{c:a,dkLen:u,DK:i,PRF:o,PRFSalt:d}=P(n,t,e,c);let s;const f=new Uint8Array(4),l=g(f),r=new Uint8Array(o.outputLen);for(let m=1,y=0;y<u;m++,y+=o.outputLen){const p=i.subarray(y,y+o.outputLen);l.setInt32(0,m,!1),(s=d._cloneInto(s)).update(f).digestInto(r),p.set(r.subarray(0,p.length));for(let h=1;h<a;h++){o._cloneInto(s).update(r).digestInto(r);for(let k=0;k<p.length;k++)p[k]^=r[k]}}return T(o,d,i,s,r)}/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */function I(n){if(typeof n!="string")throw new TypeError("invalid mnemonic type: "+typeof n);return n.normalize("NFKD")}function v(n){const t=I(n),e=t.split(" ");if(![12,15,18,21,24].includes(e.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:e}}const E=n=>I("mnemonic"+n);function S(n,t=""){return U(b,v(n).nfkd,E(t),{c:2048,dkLen:64})}export{S as U};
