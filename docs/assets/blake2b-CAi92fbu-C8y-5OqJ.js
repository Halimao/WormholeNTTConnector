import{bt as O,bu as m,bv as k,bw as y,bx as H,by as A,bz as x,bA as J,bB as E,bC as K,bD as L,bE as Z,bF as I,bG as _,bH as C,bI as U,bJ as z,bK as M,bL as F,bM as G,bN as N}from"./index-BGLdF6jF.js";const P=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),c=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),t=new Uint32Array(32);function w(b,h,s,n,r,o){const e=r[o],i=r[o+1];let l=t[2*b],a=t[2*b+1],f=t[2*h],v=t[2*h+1],p=t[2*s],g=t[2*s+1],d=t[2*n],u=t[2*n+1],B=N(l,f,e);a=I(B,a,v,i),l=B|0,{Dh:u,Dl:d}={Dh:u^a,Dl:d^l},{Dh:u,Dl:d}={Dh:_(u,d),Dl:C(u)},{h:g,l:p}=U(g,p,u,d),{Bh:v,Bl:f}={Bh:v^g,Bl:f^p},{Bh:v,Bl:f}={Bh:z(v,f,24),Bl:M(v,f,24)},t[2*b]=l,t[2*b+1]=a,t[2*h]=f,t[2*h+1]=v,t[2*s]=p,t[2*s+1]=g,t[2*n]=d,t[2*n+1]=u}function D(b,h,s,n,r,o){const e=r[o],i=r[o+1];let l=t[2*b],a=t[2*b+1],f=t[2*h],v=t[2*h+1],p=t[2*s],g=t[2*s+1],d=t[2*n],u=t[2*n+1],B=N(l,f,e);a=I(B,a,v,i),l=B|0,{Dh:u,Dl:d}={Dh:u^a,Dl:d^l},{Dh:u,Dl:d}={Dh:z(u,d,16),Dl:M(u,d,16)},{h:g,l:p}=U(g,p,u,d),{Bh:v,Bl:f}={Bh:v^g,Bl:f^p},{Bh:v,Bl:f}={Bh:F(v,f,63),Bl:G(v,f,63)},t[2*b]=l,t[2*b+1]=a,t[2*h]=f,t[2*h+1]=v,t[2*s]=p,t[2*s+1]=g,t[2*n]=d,t[2*n+1]=u}function R(b,h={},s,n,r){if(x(s),b<0||b>s)throw new Error("outputLen bigger than keyLen");const{key:o,salt:e,personalization:i}=h;if(o!==void 0&&(o.length<1||o.length>s))throw new Error("key length must be undefined or 1.."+s);if(e!==void 0&&e.length!==n)throw new Error("salt must be undefined or "+n);if(i!==void 0&&i.length!==r)throw new Error("personalization must be undefined or "+r)}class V extends J{constructor(h,s){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,x(h),x(s),this.blockLen=h,this.outputLen=s,this.buffer=new Uint8Array(h),this.buffer32=k(this.buffer)}update(h){E(this),h=m(h),K(h);const{blockLen:s,buffer:n,buffer32:r}=this,o=h.length,e=h.byteOffset,i=h.buffer;for(let l=0;l<o;){this.pos===s&&(L(r),this.compress(r,0,!1),L(r),this.pos=0);const a=Math.min(s-this.pos,o-l),f=e+l;if(a===s&&!(f%4)&&l+a<o){const v=new Uint32Array(i,f,Math.floor((o-l)/4));L(v);for(let p=0;l+s<o;p+=r.length,l+=s)this.length+=s,this.compress(v,p,!1);L(v);continue}n.set(h.subarray(l,l+a),this.pos),this.pos+=a,this.length+=a,l+=a}return this}digestInto(h){E(this),Z(h,this);const{pos:s,buffer32:n}=this;this.finished=!0,A(this.buffer.subarray(s)),L(n),this.compress(n,0,!0),L(n);const r=k(h);this.get().forEach((o,e)=>r[e]=y(o))}digest(){const{buffer:h,outputLen:s}=this;this.digestInto(h);const n=h.slice(0,s);return this.destroy(),n}_cloneInto(h){const{buffer:s,length:n,finished:r,destroyed:o,outputLen:e,pos:i}=this;return h||(h=new this.constructor({dkLen:e})),h.set(...this.get()),h.buffer.set(s),h.destroyed=o,h.finished=r,h.length=n,h.pos=i,h.outputLen=e,h}clone(){return this._cloneInto()}}class Y extends V{constructor(h={}){const s=h.dkLen===void 0?64:h.dkLen;super(128,s),this.v0l=c[0]|0,this.v0h=c[1]|0,this.v1l=c[2]|0,this.v1h=c[3]|0,this.v2l=c[4]|0,this.v2h=c[5]|0,this.v3l=c[6]|0,this.v3h=c[7]|0,this.v4l=c[8]|0,this.v4h=c[9]|0,this.v5l=c[10]|0,this.v5h=c[11]|0,this.v6l=c[12]|0,this.v6h=c[13]|0,this.v7l=c[14]|0,this.v7h=c[15]|0,R(s,h,64,16,16);let{key:n,personalization:r,salt:o}=h,e=0;if(n!==void 0&&(n=m(n),e=n.length),this.v0l^=this.outputLen|e<<8|65536|1<<24,o!==void 0){o=m(o);const i=k(o);this.v4l^=y(i[0]),this.v4h^=y(i[1]),this.v5l^=y(i[2]),this.v5h^=y(i[3])}if(r!==void 0){r=m(r);const i=k(r);this.v6l^=y(i[0]),this.v6h^=y(i[1]),this.v7l^=y(i[2]),this.v7h^=y(i[3])}if(n!==void 0){const i=new Uint8Array(this.blockLen);i.set(n),this.update(i)}}get(){let{v0l:h,v0h:s,v1l:n,v1h:r,v2l:o,v2h:e,v3l:i,v3h:l,v4l:a,v4h:f,v5l:v,v5h:p,v6l:g,v6h:d,v7l:u,v7h:B}=this;return[h,s,n,r,o,e,i,l,a,f,v,p,g,d,u,B]}set(h,s,n,r,o,e,i,l,a,f,v,p,g,d,u,B){this.v0l=h|0,this.v0h=s|0,this.v1l=n|0,this.v1h=r|0,this.v2l=o|0,this.v2h=e|0,this.v3l=i|0,this.v3h=l|0,this.v4l=a|0,this.v4h=f|0,this.v5l=v|0,this.v5h=p|0,this.v6l=g|0,this.v6h=d|0,this.v7l=u|0,this.v7h=B|0}compress(h,s,n){this.get().forEach((l,a)=>t[a]=l),t.set(c,16);let{h:r,l:o}=H(BigInt(this.length));t[24]=c[8]^o,t[25]=c[9]^r,n&&(t[28]=~t[28],t[29]=~t[29]);let e=0;const i=P;for(let l=0;l<12;l++)w(0,4,8,12,h,s+2*i[e++]),D(0,4,8,12,h,s+2*i[e++]),w(1,5,9,13,h,s+2*i[e++]),D(1,5,9,13,h,s+2*i[e++]),w(2,6,10,14,h,s+2*i[e++]),D(2,6,10,14,h,s+2*i[e++]),w(3,7,11,15,h,s+2*i[e++]),D(3,7,11,15,h,s+2*i[e++]),w(0,5,10,15,h,s+2*i[e++]),D(0,5,10,15,h,s+2*i[e++]),w(1,6,11,12,h,s+2*i[e++]),D(1,6,11,12,h,s+2*i[e++]),w(2,7,8,13,h,s+2*i[e++]),D(2,7,8,13,h,s+2*i[e++]),w(3,4,9,14,h,s+2*i[e++]),D(3,4,9,14,h,s+2*i[e++]);this.v0l^=t[0]^t[16],this.v0h^=t[1]^t[17],this.v1l^=t[2]^t[18],this.v1h^=t[3]^t[19],this.v2l^=t[4]^t[20],this.v2h^=t[5]^t[21],this.v3l^=t[6]^t[22],this.v3h^=t[7]^t[23],this.v4l^=t[8]^t[24],this.v4h^=t[9]^t[25],this.v5l^=t[10]^t[26],this.v5h^=t[11]^t[27],this.v6l^=t[12]^t[28],this.v6h^=t[13]^t[29],this.v7l^=t[14]^t[30],this.v7h^=t[15]^t[31],A(t)}destroy(){this.destroyed=!0,A(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const $=O(b=>new Y(b)),q=$;export{q as R};
